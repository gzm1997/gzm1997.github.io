<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  

  
  <title>gzm&#39;s blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="gzm&#39;s blogs">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="gzm&#39;s blogs">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="gzm&#39;s blogs">
  
    <link rel="alternate" href="/atom.xml" title="gzm&#39;s blogs" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">gzm&#39;s blogs</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-图数据库" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/06/图数据库/" class="article-date">
  <time datetime="2018-08-06T08:12:49.000Z" itemprop="datePublished">2018-08-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/06/图数据库/">图数据库</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>互联网发展带来的问题</p>
<ol>
<li>用户 系统和传感器的数据量呈指数增长 </li>
<li>数据内部的依赖和复杂度迅速增加</li>
</ol>
<p>数据库分类</p>
<ul>
<li>sql</li>
<li>nosql</li>
</ul>
<p>nosql是过去几年快速发展的<br>可以分类为</p>
<ul>
<li>键值存储库</li>
<li>BigTable实现</li>
<li>文档库</li>
<li>图形数据库</li>
</ul>
<p>备注</p>
<blockquote>
<p>BigTable是一种压缩的、高性能的、高可扩展性的，基于Google文件系统（Google File System，GFS）的数据存储系统，用于存储大规模结构化数据，适用于云端计算。优势在于扩展性和性能</p>
</blockquote>
<hr>
<h2 id="图数据库表现方式"><a href="#图数据库表现方式" class="headerlink" title="图数据库表现方式"></a>图数据库表现方式</h2><p>G = (V, E)</p>
<ul>
<li>V表示定点</li>
<li>E表示边</li>
</ul>
<p>表示图的两种常用方式</p>
<ul>
<li>邻接矩阵</li>
<li>邻接表</li>
</ul>
<p><img src="http://static.zybuluo.com/gzm1997/tichy4c8bsrfbki5obtxorun/image_1ci23g3nmnui1g6e13aeg4e1vih9.png" alt="image_1ci23g3nmnui1g6e13aeg4e1vih9.png-149.9kB"></p>
<p>底层存储问题</p>
<ul>
<li>原生图存储</li>
<li>非图后端</li>
</ul>
<p>原生图村存储好处是专门为性能和拓展性建造的 占用内存巨大 而且在一些非遍历类查询上比较困难</p>
<p>相反 序列化之后再我们一些非常成熟的非图后端上可以非常有利于运维</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/06/图数据库/" data-id="cjqjgkv6f001sqco05zoxudlo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/database/">database</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/graph/">graph</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-beego学习2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/06/beego学习2/" class="article-date">
  <time datetime="2018-08-06T08:11:35.000Z" itemprop="datePublished">2018-08-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/06/beego学习2/">beego学习2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="beego执行逻辑"><a href="#beego执行逻辑" class="headerlink" title="beego执行逻辑"></a>beego执行逻辑</h2><p><img src="http://static.zybuluo.com/gzm1997/4w8ia8vm9196vkdxpong1dvq/image_1cjtbnflsj961esq4ujqi66fm9.png" alt="image_1cjtbnflsj961esq4ujqi66fm9.png-144.5kB"></p>
<hr>
<h2 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h2><p>beego是严格遵循MVC的模式的 所以它的控制器是非常重要的 他的路由注册是有点特别的 它是一个URL前缀对应一个控制器 然后控制器里面定义不同的http methods对应的处理函数</p>
<p>一般声明一个控制器的方法就是自创建一个结构体 包含一个<strong>beego.Controller</strong>原生的控制器</p>
<p>现在我们来看一下控制器的内部<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Controller <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// 上下文数据</span></span><br><span class="line">	Ctx  *context.Context</span><br><span class="line">   <span class="comment">// 用来存储一些配置等信息非常方便	</span></span><br><span class="line">	Data <span class="keyword">map</span>[<span class="keyword">interface</span>&#123;&#125;]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 控制器的一些基本介绍信息 名字之类的</span></span><br><span class="line">	controllerName <span class="keyword">string</span></span><br><span class="line">	actionName     <span class="keyword">string</span></span><br><span class="line">	methodMapping  <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="function"><span class="keyword">func</span><span class="params">()</span> //<span class="title">method</span>:<span class="title">routertree</span></span></span><br><span class="line"><span class="function">	<span class="title">gotofunc</span>       <span class="title">string</span></span></span><br><span class="line"><span class="function">	<span class="title">AppController</span>  <span class="title">interface</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 渲染模板信息 模板名字等 这个现在而言不是很重要</span></span><br><span class="line">	TplName        <span class="keyword">string</span></span><br><span class="line">	ViewPath       <span class="keyword">string</span></span><br><span class="line">	Layout         <span class="keyword">string</span></span><br><span class="line">	LayoutSections <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span> <span class="comment">// the key is the section name and the value is the template name</span></span><br><span class="line">	TplPrefix      <span class="keyword">string</span></span><br><span class="line">	TplExt         <span class="keyword">string</span></span><br><span class="line">	EnableRender   <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 跨域数据</span></span><br><span class="line">	_xsrfToken <span class="keyword">string</span></span><br><span class="line">	XSRFExpire <span class="keyword">int</span></span><br><span class="line">	EnableXSRF <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// session数据</span></span><br><span class="line">	CruSession session.Store</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>所以一个beego控制器中含有以下几部分内容</p>
<ul>
<li>上下文数据</li>
<li>控制器基本信息</li>
<li>渲染模板信息</li>
<li>跨域信息</li>
<li>session信息</li>
</ul>
<hr>
<h2 id="json对象转struct"><a href="#json对象转struct" class="headerlink" title="json对象转struct"></a>json对象转struct</h2><p>当路由的方法是post的时候 旺旺需要post一些json对象到后端 那么将他们转为json对象就尤为必要 但是当这个struct结构含有匿名函数的时候需要注意一下</p>
<p>1.当struct没有匿名成员的时候 </p>
<p>一切跟平时将json转struct没什么区别 只注意要讲结构体内的成员首字母为大写来声明 不然没有导出的字段是无法被赋值上去的</p>
<p>2.当时结构体含有匿名成员的时候</p>
<p>我们要记住 其实<strong>匿名成员里面的所有字段都是直接属于最外面的结构体的</strong> 所以我们post表单的时候要注意 <strong>不需要给匿名成员提供key 直接将匿名成员里面的字段作为一对key-value对就行了</strong></p>
<p>例如<br>结构体设计如下<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Desc</span><br><span class="line">	Name <span class="keyword">string</span> <span class="string">`json:"name"`</span></span><br><span class="line">	Id <span class="keyword">int</span> <span class="string">`json:"id"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Desc <span class="keyword">struct</span> &#123;</span><br><span class="line">	Num <span class="keyword">int</span> <span class="string">`json:"num"`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>那么在postman这边需要这样提交post json对象<br><img src="http://static.zybuluo.com/gzm1997/txinx1cv6pze1t891yt134cb/image_1ck1fk2v9194l1vln1s2mlbl1u349.png" alt="image_1ck1fk2v9194l1vln1s2mlbl1u349.png-20.5kB"></p>
<p>结果<br><img src="http://static.zybuluo.com/gzm1997/bfhpg6w0au8poa7it1az6pjv/image_1ck1fkq7n1h2319mn1c2vdp6hmpm.png" alt="image_1ck1fkq7n1h2319mn1c2vdp6hmpm.png-9.6kB"></p>
<hr>
<h2 id="copybody-bug"><a href="#copybody-bug" class="headerlink" title="copybody bug"></a>copybody bug</h2><p>这里真的是神坑 浪费了我很多时间 在beego的post路由函数中 我们一般是这样接受发送过来的json对象的<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> err := json.Unmarshal(this.Ctx.Input.RequestBody, &amp;f); err == <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>但是有可能一直报错<strong>unexpected end of json data</strong> json对象的结构不对？但是postman上并没有显示报错啊这就很迷了</p>
<blockquote>
<p>实质上是这是因为没有设置copyrequestbody = true 所以post过去的数据一直都是空的 但是我的配置文件上一直有这句话啊 比较坑的是 其实配置文件并没有被加载进去 beego没有加载了你的配置文件 而是加载了默认的配置文件 比较坑的是beego并没有报错说配置文件找不到 所以copyrequestbody一直为false</p>
</blockquote>
<p>解决方法是在运行配置那里修改working directory修改为beego项目的根目录 这样beego就可以找到你的配置文件的正确目录了</p>
<p>真的是神坑 beego找不到配置文件目录竟然不会报错。。。</p>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/06/beego学习2/" data-id="cjqjgkv4u0005qco0o19tst0s" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/beego/">beego</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-beego入门" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/06/beego入门/" class="article-date">
  <time datetime="2018-08-06T08:10:12.000Z" itemprop="datePublished">2018-08-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/06/beego入门/">beego入门</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="入门部分"><a href="#入门部分" class="headerlink" title="入门部分"></a>入门部分</h2><p>beego跟一般Python框架不怎样一样 它有controler控制器的概念 </p>
<ul>
<li><strong>每个url对应一个controller</strong></li>
<li>controller可以从beego.Controller中继承过来</li>
<li>beego.Controller已经具有get post delete put等方法</li>
<li>我们要注册视图函数的一般做法就是<strong>重写</strong>这些方法 来定义我们自己的视图函数</li>
</ul>
<p>hello world<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"github.com/astaxie/beego"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个controller 继承beego.Controller</span></span><br><span class="line"><span class="keyword">type</span> MainController <span class="keyword">struct</span> &#123;</span><br><span class="line">	beego.Controller</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//重写get函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *MainController)</span> <span class="title">Get</span><span class="params">()</span></span> &#123;</span><br><span class="line">	c.Ctx.WriteString(<span class="string">"lalalala"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="comment">//注册路由</span></span><br><span class="line">	beego.Router(<span class="string">"/"</span>, &amp;MainController&#123;&#125;)</span><br><span class="line">	<span class="comment">//运行web app</span></span><br><span class="line">	beego.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="beego安装工具bee"><a href="#beego安装工具bee" class="headerlink" title="beego安装工具bee"></a>beego安装工具bee</h2><p>跟其他web 框架一样 beego也是可以初始化一个后端应用的文件目录结构来方便开发者进行开发的</p>
<p>创建一个新的beego项目</p>
<pre><code>bee new newProjectName
</code></pre><p>目录结构如下<br><img src="http://static.zybuluo.com/gzm1997/kjjv441biwigye0xb0iqvoe5/image_1chuh0ikb124h12l81s1fum41o5pp.png" alt="image_1chuh0ikb124h12l81s1fum41o5pp.png-29.7kB"></p>
<p>可以看到是包含static和views目录的 意味着这包含着前端部分的内容</p>
<p>创建一个api应用</p>
<pre><code>bee api apiProjectName
</code></pre><p>目录结构如下 可以看到是没有静态文件和模板文件目录了<br><img src="http://static.zybuluo.com/gzm1997/uaj4ubkkbao9s1lwprki0yur/image_1chuh6345r681h5r1i261bl0hi7p.png" alt="image_1chuh6345r681h5r1i261bl0hi7p.png-22.3kB"></p>
<p>进入项目的根目录下运行</p>
<pre><code>bee run
</code></pre><p>进行热编译 我也不知道热变异是什么</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/06/beego入门/" data-id="cjqjgkv52000bqco0g30uyplh" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/beego/">beego</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-session和cookies关系和原理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/18/session和cookies关系和原理/" class="article-date">
  <time datetime="2018-06-18T07:58:19.000Z" itemprop="datePublished">2018-06-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/18/session和cookies关系和原理/">session和cookies关系和原理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前几天思考了一下session跟cookies的关系和原理 发现以前对session跟cookies的理解一直都有误 以前我一直以为session是存在服务端 cookies存在客户端 他们的键值对是一一对应关系的 后来想了想 这其实是不完全对的</p>
<hr>
<h2 id="session和cookies的位置"><a href="#session和cookies的位置" class="headerlink" title="session和cookies的位置"></a>session和cookies的位置</h2><p>之前我们说到我们需要一种跟踪和认证客户端的机制 这种机制在客户端处表现为cookies </p>
<blockquote>
<p>cookies可以保存在浏览器缓存 磁盘中等等</p>
</blockquote>
<p>这种机制在服务端表现为session </p>
<blockquote>
<p>session可以保存在内存 缓存 memcache redis或者磁盘中等等 </p>
</blockquote>
<p>这些都是没问题的</p>
<hr>
<h2 id="cookies和session的对应关系"><a href="#cookies和session的对应关系" class="headerlink" title="cookies和session的对应关系"></a>cookies和session的对应关系</h2><p>cookies和session上的键值对其实不是一一对应关系的 甚至可以说关系不大<br>我们使用java的servlet来举例子 就可以比较清楚的说明他们的关系</p>
<p>在我们服务端这边cookies和session不是一回事 而且它们都可以被我们服务端分别进行操作</p>
<hr>
<h2 id="设置cookies"><a href="#设置cookies" class="headerlink" title="设置cookies"></a>设置cookies</h2><p>在java servlet中 给http response增加一个键值对 {“login”； “mylogin”}<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">//            add cookies</span></span><br><span class="line">    Cookie login = <span class="keyword">new</span> Cookie(<span class="string">"login"</span>, <span class="string">"mylogin"</span>);</span><br><span class="line">    resp.addCookie(login);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>客户端那边的效果 成功设置这个键值对到cookies中<br><img src="http://static.zybuluo.com/gzm1997/nvgdlijlkc9glc7fg8a94fo0/image_1cg8recrtgbg1m201gvdvu29q39.png" alt="image_1cg8recrtgbg1m201gvdvu29q39.png-3.3kB"></p>
<p>cookies原理<br><img src="http://static.zybuluo.com/gzm1997/1uh5o4j1ooowupuxpxdmtugx/image_1cg8s7r6mdbe7mf1pd51kqu2vv1g.png" alt="image_1cg8s7r6mdbe7mf1pd51kqu2vv1g.png-18.1kB"></p>
<hr>
<h2 id="设置session"><a href="#设置session" class="headerlink" title="设置session"></a>设置session</h2><p>然后我给session对象设置一个键值对 在java servlet中给session设置键值对叫做setAttribute 设置键值对{“login”: “this is my login session”}<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">//            add session attribute</span></span><br><span class="line">            HttpSession session = req.getSession();</span><br><span class="line">            session.setAttribute(<span class="string">"login"</span>, <span class="string">"this is my login session"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后我们在客户端的http response的cookies中发现新增了以下这个键值对<br><img src="http://static.zybuluo.com/gzm1997/yv98wb0592tikqvoxft3ca9j/image_1cg8rn4b81fcg80l1epc1h181corm.png" alt="image_1cg8rn4b81fcg80l1epc1h181corm.png-4.8kB"></p>
<p><strong>只是新建了一个key为jsessionid的键值对 跟我们设置的session attribute毫无关系</strong></p>
<p>其实事实是<br>服务端这边是很节省资源的 它不是建立TCP连接之后就直接给客户端简历一个session 而是执行到如下语句<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HttpSession session = req.getSession();</span><br></pre></td></tr></table></figure></p>
<p>这时候才给客户端新建一个session对象(如果没有session则新建一个session 如果有则返回) 这个session对象含有一个<strong>attribute map</strong>一个映射表来存储我们给session设置的一些键值对 当我们set attribute之后 这些键值对存在attribute map之中 并且会<strong>http response新建一个特别的键值对</strong></p>
<p>这个键值对就是我们上面看到的那个跟我们设置的session attribute毫无关系的cookies键值对</p>
<p><img src="http://static.zybuluo.com/gzm1997/yv98wb0592tikqvoxft3ca9j/image_1cg8rn4b81fcg80l1epc1h181corm.png" alt="image_1cg8rn4b81fcg80l1epc1h181corm.png-4.8kB"><br>这个jsessionid的cookies值顾名思义就是在cookies中用来标记这个客户端属于哪个session的唯一属性</p>
<blockquote>
<p>所以说我们设置的所有session attribute都是存在服务端的本地的  给客户端那边传送过去关于session那部分的内容仅仅只是一个用来标识客户端所属session的session id 而session的所有内容都是存在服务端本地 之后对于每次客户端的请求 服务端都可以根据它请求头的session id这个cookie值(名字因所用框架有别 上面使用servlet 是jsessionid)来证明它是那个session的 然后根据这个session id在内存缓存memcache或者redis中找到这个session 继而找到这个session用来存键值对(就是attributes)的attribute map 从而找到我们在session中设置的内容</p>
</blockquote>
<p>所以说cookies和session的内容 本质上除了需要在cookies上设置一个session id的cookies值来标记客户端所属session 其他基本毫无关系的 更不存在以前理解的一一对应关系</p>
<p>session原理<br><img src="http://static.zybuluo.com/gzm1997/r7322ipu855h7ukdmmkszcml/image_1cg8u36631o2ft241indpi019qj2a.png" alt="image_1cg8u36631o2ft241indpi019qj2a.png-39.6kB"></p>
<p>综上所述</p>
<ul>
<li>cookies是一种存储在客户端的 对客户端进行跟踪和认证的机制</li>
<li>session是一种存储在服务端的 对客户端进行跟踪和认证的机制 session的设置需要给cookies设置一个特殊的sessionid字段值</li>
<li>对于服务端开发者来说 这两种机制都是可选的 并且是可以<strong>结合使用</strong>的 但是<strong>他们之间不是一回事</strong></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/06/18/session和cookies关系和原理/" data-id="cjqjgkv67001jqco0mtpxnzi7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cookies/">cookies</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/session/">session</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-servlet登录demo" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/16/servlet登录demo/" class="article-date">
  <time datetime="2018-06-16T05:27:36.000Z" itemprop="datePublished">2018-06-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/16/servlet登录demo/">servlet登录demo</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><a href="https://github.com/gzm1997/servletLogin" target="_blank" rel="noopener">源代码地址</a><br>因为最近这段时间在看java web开发的一些东西 因为spring mvc框架是封装了servlet而来的 所以觉得很有必要学习一下servlet 以便后面如果学习spring mvc等框架的时候可以有助于理解 进而写了一个包含mysql连接 cookies设置 session attribute设置和检验的简单demo</p>
<p>servlet架构<br><img src="http://www.runoob.com/wp-content/uploads/2014/07/servlet-arch.jpg" alt="servlet架构"></p>
<p>servlet生命周期<br><img src="http://static.zybuluo.com/gzm1997/aymbru82ndv4nfyd37n4252g/image_1cg3glqm518pqbbo11jn190i145p4r.png" alt="image_1cg3glqm518pqbbo11jn190i145p4r.png-20.8kB"></p>
<ol>
<li>第一个到达服务器的 HTTP 请求被委派到 Servlet 容器。</li>
<li>Servlet 容器在调用 service() 方法之前加载 Servlet。</li>
<li>然后 Servlet 容器处理由多个线程产生的多个请求，每个线程执行一个单一的 Servlet 实例的 service() 方法。</li>
</ol>
<p><img src="http://www.runoob.com/wp-content/uploads/2014/07/Servlet-LifeCycle.jpg" alt="架构"></p>
<p>使用了tomcat作为<strong>servlet容器</strong> </p>
<blockquote>
<p>tomcat实现了对servlet和jsp的支持 并提供了作为web服务器的一些特有功能<br>如Tomcat管理和控制平台、安全域管理和Tomcat阀等 由于tomcat内置了一个http服务器 它也可以被单独视为一个web服务器<br>但是不能将tomcat和apache http web服务器混淆 这两个http web服务器不是捆绑在一起的<br>tomcat的可以通过xml文件格式的配置文件进行配置</p>
</blockquote>
<hr>
<h2 id="在intellij-idea进行tomcat-server运行配置"><a href="#在intellij-idea进行tomcat-server运行配置" class="headerlink" title="在intellij idea进行tomcat server运行配置"></a>在intellij idea进行tomcat server运行配置</h2><p>这个在网上找到一个博客写的很详尽 这里就不重复了<br><a href="https://blog.csdn.net/yhao2014/article/details/45740111" target="_blank" rel="noopener">tomcat server运行配置</a></p>
<hr>
<h2 id="login-demo"><a href="#login-demo" class="headerlink" title="login demo"></a>login demo</h2><p>文件结构<br><img src="http://static.zybuluo.com/gzm1997/73f3jnpbm8dinpgn9uwiyn9q/image_1cg3ea5e41vtr11mj1po41hps12e313.png" alt="image_1cg3ea5e41vtr11mj1po41hps12e313.png-27kB"></p>
<p>数据库<br>在mysql中设置一个如下结构的表(因为仅仅是写一个简单的登录demo 所以没有考虑密码哈希之类的问题)<br><img src="http://static.zybuluo.com/gzm1997/g9nfvb6vx2rfn9won6t9b87o/image_1cg3e73p61b2dtiafpiejlbd99.png" alt="image_1cg3e73p61b2dtiafpiejlbd99.png-93.1kB"><br>添加一个实例<br><img src="http://static.zybuluo.com/gzm1997/h9lx71tb1efxybh4th3ka3n9/image_1cg3e861fmdd692ca71oup149pm.png" alt="image_1cg3e861fmdd692ca71oup149pm.png-68.7kB"></p>
<p>数据库连接<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> servletPackage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FindPsw</span> </span>&#123;</span><br><span class="line"><span class="comment">//    加载JDBC引擎的路径</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String JDBC_DRIVER = <span class="string">"com.mysql.jdbc.Driver"</span>;</span><br><span class="line"><span class="comment">//    数据库链接的URI</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String DB_URL = <span class="string">"jdbc:mysql://localhost:3306/javaTest"</span>;</span><br><span class="line"><span class="comment">//    连接数据库的用户名</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String USER = <span class="string">"root"</span>;</span><br><span class="line"><span class="comment">//    数据库密码</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String PSW = <span class="string">"Gzm20125"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPsw</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line"><span class="comment">//        数据库连接对象</span></span><br><span class="line">        Connection conn;</span><br><span class="line"><span class="comment">//        执行语句的statement对象 类似于python-connector的cursor</span></span><br><span class="line">        Statement stmt;</span><br><span class="line">        String psw;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//            加载JDBC引擎</span></span><br><span class="line">            Class.forName(JDBC_DRIVER);</span><br><span class="line"><span class="comment">//            建立数据库链接</span></span><br><span class="line">            conn = DriverManager.getConnection(DB_URL, USER, PSW);</span><br><span class="line"><span class="comment">//            获取statement</span></span><br><span class="line">            stmt = conn.createStatement();</span><br><span class="line">            String stmtToExec = String.format(<span class="string">"select psw from testUser where name = '%s';"</span>, name);</span><br><span class="line">            System.out.println(<span class="string">"exec string is "</span> + stmtToExec);</span><br><span class="line"><span class="comment">//            执行查询语句 返回结果</span></span><br><span class="line">            ResultSet rs = stmt.executeQuery(stmtToExec);</span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                psw = rs.getString(<span class="string">"psw"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                psw = <span class="string">""</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            rs.close();</span><br><span class="line">            stmt.close();</span><br><span class="line">            conn.close();</span><br><span class="line">            <span class="keyword">return</span> psw;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>登录页面<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> servletPackage;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="comment">/* 声明/login资源 使用Login这个类作作为视图类 */</span></span><br><span class="line"><span class="meta">@WebServlet</span>(<span class="string">"/login"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Login</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="comment">//    重写doGet方法 处理get请求</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">//        在response中写入一个登录form</span></span><br><span class="line">        PrintWriter out = resp.getWriter();</span><br><span class="line">        out.println(<span class="string">"&lt;!DOCTYPE html&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;html lang='en-US'&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;head&gt;\n"</span> +</span><br><span class="line">                <span class="string">"    &lt;meta charset='utf-8'&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;/head&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;body&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;h1&gt;login&lt;/h1&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;form action='/postDeal' method='post'&gt;\n"</span> +</span><br><span class="line">                <span class="string">"    &lt;input type='text' name='user'&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;br&gt;"</span> +</span><br><span class="line">                <span class="string">"    &lt;input type='text' name='password'&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;br&gt;"</span> +</span><br><span class="line">                <span class="string">"    &lt;input type='submit'&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;/form&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;/body&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;/html&gt;"</span></span><br><span class="line">        );</span><br><span class="line">        out.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>表单 cookies session的处理<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> servletPackage;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(<span class="string">"/postDeal"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PostDeal</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">//        获取表单中的用户和密码</span></span><br><span class="line">        String user = req.getParameter(<span class="string">"user"</span>);</span><br><span class="line">        String psw = req.getParameter(<span class="string">"password"</span>);</span><br><span class="line"><span class="comment">//        使用刚刚数据库连接的类进行数据库查询 获取正确密码</span></span><br><span class="line">        FindPsw f = <span class="keyword">new</span> FindPsw();</span><br><span class="line">        String rightPsw = f.getPsw(user);</span><br><span class="line">        System.out.println(<span class="string">"right psw is "</span> + rightPsw);</span><br><span class="line">        PrintWriter out = resp.getWriter();</span><br><span class="line"><span class="comment">//        如果密码正确</span></span><br><span class="line">        <span class="keyword">if</span> (psw.equals(rightPsw)) &#123;</span><br><span class="line"><span class="comment">//            add cookies</span></span><br><span class="line">            Cookie login = <span class="keyword">new</span> Cookie(<span class="string">"login"</span>, <span class="string">"mylogin"</span>);</span><br><span class="line">            resp.addCookie(login);</span><br><span class="line"></span><br><span class="line"><span class="comment">//            add session attribute</span></span><br><span class="line">            HttpSession session = req.getSession();</span><br><span class="line">            session.setAttribute(<span class="string">"login"</span>, <span class="string">"this is my login session"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//            add response text</span></span><br><span class="line">            out.println(</span><br><span class="line">                    <span class="string">"&lt;p&gt;login successfully user "</span> + user + <span class="string">" psw is "</span> + psw + <span class="string">"&lt;/p&gt;"</span> +</span><br><span class="line">                    <span class="string">"&lt;a href='/checkSession'&gt;this is a page to check whether set session attribute&lt;/a&gt;"</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            out.println(<span class="string">"&lt;p&gt;psw is error&lt;/p&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 登录表单提交过来这个书图类之后 doPost函数首先接受到请求 随之转发给doGet函数 由doGet函数进行处理</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        doGet(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>检查session attribute是否被成功设置<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> servletPackage;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="comment">//这个视图用来测试客户端是否被成功设置了session attribute</span></span><br><span class="line"><span class="meta">@WebServlet</span>(<span class="string">"/checkSession"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">checkSession</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">//        获取客户端的session</span></span><br><span class="line">        HttpSession session = req.getSession();</span><br><span class="line"><span class="comment">//        获取session attribute</span></span><br><span class="line">        String login = (String) session.getAttribute(<span class="string">"login"</span>);</span><br><span class="line">        System.out.println(<span class="string">"login session is "</span> + login);</span><br><span class="line">        PrintWriter out = resp.getWriter();</span><br><span class="line">        out.println(<span class="string">"login session is "</span> + login);</span><br><span class="line">        out.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p>登录</p>
<p><img src="http://static.zybuluo.com/gzm1997/eguchcsom6t3n75nvgs08m4x/image_1cg3fmvge1e441h2c16ep19pvgb51g.png" alt="image_1cg3fmvge1e441h2c16ep19pvgb51g.png-19.2kB"></p>
<hr>
<p>登录成功</p>
<p><img src="http://static.zybuluo.com/gzm1997/7q5z6ijpf21c8efh36vf5b0y/image_1cg3frqlm1r3bnr315g2oc8gdl1t.png" alt="image_1cg3frqlm1r3bnr315g2oc8gdl1t.png-71.7kB"></p>
<hr>
<p>登录失败</p>
<p><img src="http://static.zybuluo.com/gzm1997/h4queqwp124mgz26un4tsdim/image_1cg3fsovg1h0r6c8nj41rft1k8q2a.png" alt="image_1cg3fsovg1h0r6c8nj41rft1k8q2a.png-62.4kB"></p>
<hr>
<p>检测session attribute</p>
<p><img src="http://static.zybuluo.com/gzm1997/2wvtj6w7e3ot8ahcopapkmap/image_1cg3ftt2f1jm9eo3phe12vvh0r2n.png" alt="image_1cg3ftt2f1jm9eo3phe12vvh0r2n.png-67.6kB"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/06/16/servlet登录demo/" data-id="cjqjgkv5z0018qco0qgv74f7r" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/servlet/">servlet</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tomcat/">tomcat</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-aiohttp-session" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/13/aiohttp-session/" class="article-date">
  <time datetime="2018-06-13T02:50:05.000Z" itemprop="datePublished">2018-06-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/13/aiohttp-session/">aiohttp session</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="cookie和session"><a href="#cookie和session" class="headerlink" title="cookie和session"></a>cookie和session</h2><p>服务端和客户端之间的联系一般是根据http协议来进行的 但是http协议是无状态的 无状态会有状态的概念大概如下</p>
<p>有状态</p>
<ol>
<li>甲：你吃午饭了吗</li>
<li>乙：吃了</li>
<li>甲：吃了什么菜</li>
<li>乙：吃了鸡蛋</li>
</ol>
<p>无状态</p>
<ol>
<li>甲：你吃午饭了吗</li>
<li>乙：吃了</li>
<li>甲：吃了什么菜</li>
<li>乙：你说什么时候吃什么菜 早饭？午饭？还是晚饭</li>
</ol>
<p>因此服务端和客户端之间需要一种机制来记录用户的状态 这种机制在客户端那边是cookies 在服务端那边是session<br>cookies可以存储在磁盘 内存里面 session可以存储在内存 缓存 redis甚至磁盘中</p>
<hr>
<h2 id="aiohttp-session"><a href="#aiohttp-session" class="headerlink" title="aiohttp session"></a>aiohttp session</h2><p>flask框架具有内置的session机制 我以前用起来觉得非常方便以至于我觉得这个不重要 aiohttp不具有内置的session机制 但是具有第三方模块支持 aiohttp_session</p>
<p>安装这个第三方模块真的挺费事 因为依赖模块实在太多了 而且aiohttp_session是可以依赖redis作为缓存的 还需要安装redis和一些相关模块 下面的开始的实例我没有使用redis作为存储位置 而是使用了EncryptedCookieStorage 后面附加了使用redis存储session的例子</p>
<p>dependencies</p>
<ul>
<li>python3.5.3+</li>
<li>cryptography </li>
<li>aioredis</li>
</ul>
<p>安装模块</p>
<ul>
<li>pip3 install cryptography(必要时进行upgrade 可能版本太低)</li>
<li>pip3 install aiohttp_session[secure]</li>
<li>pip3 install aiohttp_session[aioredis] (需要安装redis libhiredis-dev hiredis libssl-dev)</li>
<li>pip3 install aiohttp_session[aiomcache]</li>
<li><p>pip3 install aiohttp_sessionsss</p>
<p>上面的安装问题真的太多 谷歌好几次才解决</p>
</li>
</ul>
<hr>
<h2 id="存储位置选择"><a href="#存储位置选择" class="headerlink" title="存储位置选择"></a>存储位置选择</h2><p>所有仓库是使用名为AIOHTTP_COOKIE_SESSION的对象来进行存储数据的</p>
<p>可以使用的仓库有</p>
<ul>
<li>SimpleCookieStorage 把session数据以明文json字符串的格式存在cookies body中 只用来测试 非常不安全</li>
<li>EncryptedCookieStorage 存储数据在cookie中的格式跟SimpleCookieStorage一样 但是使用了cryptography的Fernet cipher加密算法进行加密</li>
<li>RedisStorage 存json化的数据到redis中 格式是name+reids key</li>
<li>MemcachedStorage 跟RedisStorage类似 但是使用memcache数据库进行存储</li>
</ul>
<hr>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>使用上跟flask的session大同小异 但是需要在init app阶段将session安装到app上 设定一个32位bytes作为加密密钥 跟flask session的secret key类似</p>
<p>session是一个dict like的对象</p>
<p>设定session<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> aiohttp <span class="keyword">import</span> web</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> aiohttp_session <span class="keyword">import</span> get_session</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(request)</span>:</span></span><br><span class="line">    engine = <span class="keyword">await</span> aio_engine.init_engine()</span><br><span class="line">    data = <span class="keyword">await</span> request.json()</span><br><span class="line">    print(<span class="string">"data"</span>, data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"name"</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">"psw"</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">return</span> web.json_response(&#123;</span><br><span class="line">            <span class="string">"status"</span>: <span class="keyword">False</span></span><br><span class="line">        &#125;)</span><br><span class="line">    name = data[<span class="string">"name"</span>]</span><br><span class="line">    psw = data[<span class="string">"psw"</span>]</span><br><span class="line">    verify = <span class="keyword">await</span> keeper.verify(engine, name = name, psw = psw)</span><br><span class="line">    <span class="keyword">if</span> verify:</span><br><span class="line">        session = <span class="keyword">await</span> get_session(request)</span><br><span class="line">        session[<span class="string">"ooad"</span>] = name</span><br><span class="line">        session[<span class="string">"login"</span>] = psw</span><br><span class="line">        session[<span class="string">"time"</span>] = str(datetime.datetime.now())</span><br><span class="line">        <span class="keyword">return</span> web.json_response(&#123;</span><br><span class="line">            <span class="string">"status"</span>: <span class="keyword">True</span></span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">return</span> web.json_response(&#123;</span><br><span class="line">        <span class="string">"status"</span>: <span class="keyword">False</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure></p>
<p>检查是否含有具体session字段值<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> aiohttp <span class="keyword">import</span> web</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> aiohttp_session <span class="keyword">import</span> get_session</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">need_cookies_page</span><span class="params">(request)</span>:</span></span><br><span class="line">    engine = <span class="keyword">await</span> aio_engine.init_engine()</span><br><span class="line">    session = <span class="keyword">await</span> get_session(request)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"ooad"</span> <span class="keyword">not</span> <span class="keyword">in</span> session <span class="keyword">or</span> <span class="string">"login"</span> <span class="keyword">not</span> <span class="keyword">in</span> session <span class="keyword">or</span> <span class="string">"time"</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> web.json_response(&#123;</span><br><span class="line">            <span class="string">"status"</span>: <span class="keyword">False</span></span><br><span class="line">        &#125;)</span><br><span class="line">    name = session[<span class="string">"ooad"</span>]</span><br><span class="line">    psw = session[<span class="string">"login"</span>]</span><br><span class="line">    r = <span class="keyword">await</span> keeper.verify(engine, name = name, psw = psw)</span><br><span class="line">    <span class="keyword">if</span> r:</span><br><span class="line">        <span class="keyword">return</span> web.json_response(&#123;</span><br><span class="line">            <span class="string">"status"</span>: <span class="keyword">True</span></span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">return</span> web.json_response(&#123;</span><br><span class="line">        <span class="string">"status"</span>: <span class="keyword">False</span></span><br><span class="line">    &#125;)</span><br><span class="line">`</span><br></pre></td></tr></table></figure></p>
<p>setup app<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setup(app, EncryptedCookieStorage(<span class="string">b'Thirty  two  length  bytes  key.'</span>))</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p>login result<br><img src="http://static.zybuluo.com/gzm1997/jkg1fhumdt69h3ycqy4jn5um/image_1cfrgldqfjrht9n1gva149ocj423.png" alt="image_1cfrgldqfjrht9n1gva149ocj423.png-72.7kB"><br>login cookies<br><img src="http://static.zybuluo.com/gzm1997/wopqky454vfub9ksx4zwrxuy/image_1cfrgm0d8nov172b2mj10ta4g62g.png" alt="image_1cfrgm0d8nov172b2mj10ta4g62g.png-46.1kB"><br>cookies check<br><img src="http://static.zybuluo.com/gzm1997/rez3qy3mv69mkbvfsf9956v8/image_1cfrgn8mh1vf717qu1elcqdv8ur2t.png" alt="image_1cfrgn8mh1vf717qu1elcqdv8ur2t.png-43.3kB"></p>
<hr>
<h2 id="使用redis存储session"><a href="#使用redis存储session" class="headerlink" title="使用redis存储session"></a>使用redis存储session</h2><p>这里有个问题 就是aiohttp本事内置一个asyncio event loop执行所有跟app相关的协程了 但是当我们使用redis作为仓库进行存储session的时候需要使用到aioredis进行支持 但是这个也是异步io连接模块 因此我们初始化redis pool的时候也需要一个event loop进行运行这个初始化的协程 一旦这个event loop跟web.run_app混在一起就会报错 event loop is already run</p>
<p>正确的做法是分开 并且在执行redis pool连接的event loop run_until_complete处获取返回值 得到需要的storage</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> aiohttp_session <span class="keyword">import</span> setup, redis_storage</span><br><span class="line"><span class="keyword">import</span> aioredis</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">get_storage</span><span class="params">()</span>:</span></span><br><span class="line">    redis = <span class="keyword">await</span> aioredis.create_pool((<span class="string">"localhost"</span>, <span class="number">6379</span>))</span><br><span class="line">    <span class="keyword">return</span>  redis_storage.RedisStorage(redis)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setup_session_support</span><span class="params">(app)</span>:</span></span><br><span class="line">    storage = asyncio.get_event_loop().run_until_complete(get_storage())</span><br><span class="line">    setup(app, storage)</span><br><span class="line">    <span class="keyword">return</span> app</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app = session_redis.setup_session_support(app)</span><br></pre></td></tr></table></figure>
<p>效果<br>可以看到生成的cookies值确实存在了redis中<br>postman中获取的cookies<br><img src="http://static.zybuluo.com/gzm1997/scr363l8y5g6lbig4pwa41d1/image_1cfs5ia7pm0mke1hcn13edld9m.png" alt="image_1cfs5ia7pm0mke1hcn13edld9m.png-18.6kB"><br>redis中也存有一样的cookies<br><img src="http://static.zybuluo.com/gzm1997/f7wpnf2du5q1spknuypy56dc/image_1cfs5h8s6st01coa4491gh0bic9.png" alt="image_1cfs5h8s6st01coa4491gh0bic9.png-20kB"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/06/13/aiohttp-session/" data-id="cjqjgkv4t0004qco0i4yqr9qk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aiohttp/">aiohttp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/session/">session</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-aiohttp的跨域问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/10/aiohttp的跨域问题/" class="article-date">
  <time datetime="2018-06-10T06:17:44.000Z" itemprop="datePublished">2018-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/10/aiohttp的跨域问题/">aiohttp的跨域问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h2><p>以前使用flask框架的时候一直都是没有前后端分离 现在使用aiohttp框架 并且前端使用vue 前后端分离 因此出现了跨域的问题</p>
<p>不同浏览器对跨域的支持也是不一样的 支持跨域的浏览器主要有</p>
<ul>
<li>Chrome 3+</li>
<li>Firefox 3.5+</li>
<li>Opera 12+</li>
<li>Safari 4+</li>
<li>Internet Explorer 8+</li>
</ul>
<p>标准的跨域请求默认是不发送任何的cookies的 如果需要把cookies作为请求的一部分 需要将请求 比如js底层的XMLHttpRequest请求的withCredentials属性设置为true</p>
<pre><code>xhr.withCredentials = true;
</code></pre><p>相应的服务端那边需要设置Access-Control-Allow-Credentials为true来允许cookies的传送</p>
<pre><code>Access-Control-Allow-Credentials: true
</code></pre><p>withCredentials属性将让request包含来自远程域的任何cookies 同时它也设置任何来自远程域的cookies 要注意这些cookies还遵循同域标准的 因此你的javascrpt代码不能访问来自document.cookie或者responset header的cookies 这些cookies只可以被远程域控制</p>
<p>除了javascrip代码需要根据浏览器对cors支持程度不一样需要恰当的作出跨域请求 例如如下代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create the XHR object.</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createCORSRequest</span>(<span class="params">method, url</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">"withCredentials"</span> <span class="keyword">in</span> xhr) &#123;</span><br><span class="line">    <span class="comment">// XHR for Chrome/Firefox/Opera/Safari.</span></span><br><span class="line">    xhr.open(method, url, <span class="literal">true</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> XDomainRequest != <span class="string">"undefined"</span>) &#123;</span><br><span class="line">    <span class="comment">// XDomainRequest for IE.</span></span><br><span class="line">    xhr = <span class="keyword">new</span> XDomainRequest();</span><br><span class="line">    xhr.open(method, url);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// CORS not supported.</span></span><br><span class="line">    xhr = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> xhr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Helper method to parse the title tag from the response.</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTitle</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> text.match(<span class="string">'&lt;title&gt;(.*)?&lt;/title&gt;'</span>)[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Make the actual CORS request.</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeCorsRequest</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// This is a sample server that supports CORS.</span></span><br><span class="line">  <span class="keyword">var</span> url = <span class="string">'http://html5rocks-cors.s3-website-us-east-1.amazonaws.com/index.html'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> xhr = createCORSRequest(<span class="string">'GET'</span>, url);</span><br><span class="line">  <span class="keyword">if</span> (!xhr) &#123;</span><br><span class="line">    alert(<span class="string">'CORS not supported'</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Response handlers.</span></span><br><span class="line">  xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> text = xhr.responseText;</span><br><span class="line">    <span class="keyword">var</span> title = getTitle(text);</span><br><span class="line">    alert(<span class="string">'Response from CORS request to '</span> + url + <span class="string">': '</span> + title);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  xhr.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'Woops, there was an error making the request.'</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  xhr.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>服务端也需要一定的cors支持<br>在客户端和服务端之间的传输 一般客户端需要作出一些附加的headers和附加的请求 这些请求一般是隐藏的 但是可以抓包发现<br><img src="http://static.zybuluo.com/gzm1997/hc326fdj136namfjcbsu0vbv/image_1cfk1f1dvn7bpjdc6k3q61gc3m.png" alt="image_1cfk1f1dvn7bpjdc6k3q61gc3m.png-29.4kB"></p>
<p>跨域请求分类</p>
<ol>
<li>简单跨域请求</li>
<li>不简单跨域请求</li>
</ol>
<p>处理简单跨域请求</p>
<ul>
<li>HTTP方法是下面其中一种<ul>
<li>HEAD</li>
<li>GET</li>
<li>POST</li>
</ul>
</li>
<li>HTTP头部是<ul>
<li>Accept</li>
<li>Accept-Language</li>
<li>Content-Language</li>
<li>Last-Event-ID</li>
<li>Content-Type, 但是仅仅当值为</li>
<li>application/x-www-form-urlencoded</li>
<li>multipart/form-data</li>
<li>text/plain</li>
</ul>
</li>
</ul>
<p>简单跨域请求这样命名的原因是因为他们可以让浏览器不做处跨域请求也可以访问到 比如JOPN请求或者html的表单form 这些情况不存在跨域的问题</p>
<p><a href="https://www.cnblogs.com/dowinning/archive/2012/04/19/json-jsonp-jquery.html" target="_blank" rel="noopener">JSONP是什么</a></p>
<p>一个有效的服务器response<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin: http://api.bob.com</span><br><span class="line">Access-Control-Allow-Credentials: true</span><br><span class="line">Access-Control-Expose-Headers: FooBar</span><br><span class="line">Content-Type: text/html; charset=utf-8</span><br></pre></td></tr></table></figure></p>
<p>其中以下是跨域请求必须的</p>
<ul>
<li>Access-Control-Allow-Origin</li>
</ul>
<p>Access-Control-Allow-Origin这个属性必须在server response的headers中 这个属性用来说明哪个域可以访问你的数据 如果缺少会导致跨域的失败 如果像让所有的域可以访问你的数据 那么可以使用* </p>
<p>Access-Control-Allow-Credentials默认来说 cookies是不可以包含在跨域请求中 使用这个属性说明cookies可以包含在跨域请求头部中 这个属性跟上面说到的withCredentials协同工作的(withCredentials是js客户端这边设置的 Access-Control-Allow-Credentials是服务端这边设置的)</p>
<p>Access-Control-Expose-Headers  在js的XMLHttpRequest 2对象中可以使用getResponseHeader()的方法来获取一个response的header 在跨域请求中 getResponseHeader()方法只可以获取简单的response header 简单的response header被定义为如下</p>
<ul>
<li>Cache-Control</li>
<li>Content-Language</li>
<li>Content-Type</li>
<li>Expires</li>
<li>Last-Modified</li>
<li>Pragma</li>
</ul>
<p>如果像客户端可以获取其他的headers就需要使用Access-Control-Expose-Headers这个属性了</p>
<p>处理不简单跨域请求<br>不简单跨域请求在客户端看起来跟简单跨域请求差不多 但是它在有运行两个附加的请求</p>
<ol>
<li>首先客户端会发送一个preflight request 这个请求用于获取服务端的允许来发送真正的请求</li>
<li>获取允许之后 客户端发送真正的请求</li>
<li>因为preflight request是可以被缓存的 所以不需要每次请求都发送一次preflight request</li>
</ol>
<hr>
<h2 id="跨域例子"><a href="#跨域例子" class="headerlink" title="跨域例子"></a>跨域例子</h2><p>有以下api</p>
<pre><code>http://localhost:8080/api/product/1
</code></pre><p>以上api可以获取以下json个格式对象<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">"name"</span>: <span class="string">"pork"</span>,</span><br><span class="line">    <span class="string">"picture"</span>: <span class="string">"https://demo.pork.png"</span>,</span><br><span class="line">    <span class="string">"price"</span>: <span class="number">53</span>,</span><br><span class="line">    <span class="string">"description"</span>: <span class="string">"this is a pork"</span>,</span><br><span class="line">    <span class="string">"rating"</span>: <span class="number">0.8</span>,</span><br><span class="line">    <span class="string">"amount"</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="string">"likes"</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">"tag_id"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">"sales_permonth"</span>: <span class="number">382</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在一个html的script中使用jquery的$.get访问上面的api 因为需要从不同域名或者不同端口下加载资源 所以浏览器出于安全考虑会阻止这个api的访问 值得一提的是postman并不是严格按照这个标准的</p>
<p>测试跨域的html<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>cors_test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">		$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">			$(<span class="string">"#submit"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">				$.get(<span class="string">"http://localhost:8080/api/product/1"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data, status</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">					alert(<span class="string">"data:"</span> + data + <span class="string">"\nStatus:"</span> + status);</span></span><br><span class="line"><span class="undefined">				&#125;);</span></span><br><span class="line"><span class="undefined">			&#125;);</span></span><br><span class="line"><span class="undefined">		&#125;);</span></span><br><span class="line"><span class="undefined">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"submit"</span>&gt;</span>submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>结果 出现跨域请求被禁止的报错<br><img src="http://static.zybuluo.com/gzm1997/z1x5btxclnhr8q4cnimb385l/image_1cfjvf6ui2ohpq1fbh19kjftm9.png" alt="image_1cfjvf6ui2ohpq1fbh19kjftm9.png-78.9kB"></p>
<hr>
<h2 id="aiohttp的跨域问题解决"><a href="#aiohttp的跨域问题解决" class="headerlink" title="aiohttp的跨域问题解决"></a>aiohttp的跨域问题解决</h2><p>因为aiohttp框架本身是不支持跨域的 所以我们需要使用一个拓展包<strong>aiohtto_cors</strong></p>
<p>pip安装</p>
<pre><code>pip install aiohttp_cors
</code></pre><p>具体使用方法请看<a href="https://github.com/aio-libs/aiohttp-cors#usage" target="_blank" rel="noopener">aiohttp_cors</a></p>
<p>我系统分析与设计项目选择<a href="https://github.com/gzm1997/ooad/blob/master/aiohttp_polls/routes.py" target="_blank" rel="noopener">解决详情</a><br><img src="http://static.zybuluo.com/gzm1997/r0c7dc5v5mqrrb4jjm4vneod/image_1cfk4pnuuoi31aan1rmn1nr58s91g.png" alt="image_1cfk4pnuuoi31aan1rmn1nr58s91g.png-85.8kB"></p>
<p>结果 跨域请求成功<br><img src="http://static.zybuluo.com/gzm1997/aqsy4jbobs9al3xulxm13sy6/image_1cfk4ucj71ao11suj1r13j0taer1t.png" alt="image_1cfk4ucj71ao11suj1r13j0taer1t.png-82.1kB"></p>
<p>最后附加flask跨域问题<a href="https://flask-cors.readthedocs.io/en/latest/" target="_blank" rel="noopener">解决方法flask_cors</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/06/10/aiohttp的跨域问题/" data-id="cjqjgkv4r0003qco0yzouiqm0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aiohttp/">aiohttp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cors/">cors</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-nginx-supervisor部署aiohttp" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/08/nginx-supervisor部署aiohttp/" class="article-date">
  <time datetime="2018-06-08T07:18:32.000Z" itemprop="datePublished">2018-06-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/08/nginx-supervisor部署aiohttp/">nginx+supervisor部署aiohttp</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>服务器上的部署问题一直很让我头疼 因为我一直是一个在windows平台上开发的 但是vps一直都是选择ubuntu16.04居多 因为在windos系统上 权限是一个总是不是被注意的事情 但是在ubuntu系统上部署web后端的时候 权限问题尤为重要</p>
</blockquote>
<hr>
<h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><p>为什么选择nginx+supervisor这样的组合来部署 因为</p>
<p>优点</p>
<ul>
<li>nginx是一个完美的前端服务器 可以防止基于畸形的http协议的攻击等等</li>
<li>使用nginx运行几个aiohttp实例可以使用CPU多核</li>
<li>nginx对static静态文件的支持比aiohttp的内置的静态文件支持更快</li>
<li>supervisor主要是为了系统崩溃或者重启之后重新运行web app实例 怎么kill也kill不掉</li>
</ul>
<p>缺点</p>
<ul>
<li>配置比其他组合方式麻烦一点</li>
</ul>
<p><a href="https://aiohttp.readthedocs.io/en/stable/deployment.html#nginx-supervisord" target="_blank" rel="noopener">参考链接</a></p>
<p>由于选择使用nginx+superviosr的组合方式部署aiohttp 所以要先下载nginx和supervisor 这个没什么问题 自行谷歌即可 但是要注意点</p>
<blockquote>
<p>因为aiohttp是只可以支持python3.5.3+的 但是好巧不巧ubuntu16.04的自带python版本是python3.5.2 这下有点蛋疼 我给的建议是保留python3.5 另外安装python3.6</p>
<p>因为ubuntu系统以及很多像sublime等软件都是依赖py2或者py3.5的 一旦卸载或者修改了/use/bin/python的链接<br>会导致一系列版本不兼容的问题 我试过最严重的是卸载了python3.5 并且修改默认python版本为3.6 系统崩溃<br>折腾了很久最后只能重装系统</p>
<p>为什么我要说这个呢 因为supervisor依赖于ubuntu的py2的<br>所以最好不要卸载任何版本python和修改系统默认的python版本 最好就另行安装python3.6 终端中使用python3.6调用即可</p>
</blockquote>
<p>项目代码放置于/var/www/aio_ooad下<br><img src="http://static.zybuluo.com/gzm1997/0wr0fcj2lo4yhzqwxxtaybpo/image_1cff1giub10gmo07k6b16gjv339.png" alt="image_1cff1giub10gmo07k6b16gjv339.png-71.6kB"></p>
<hr>
<h2 id="nginx配置"><a href="#nginx配置" class="headerlink" title="nginx配置"></a>nginx配置</h2><ul>
<li>nginx配置文件 /etc/nginx/nginx.conf</li>
<li>nginx日志文件 <ul>
<li>/var/log/nginx/access.log</li>
<li>/var/log/nginx/error.log</li>
</ul>
</li>
</ul>
<p>/etc/nginx/nginx.conf<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">  server &#123;</span><br><span class="line">    listen <span class="number">80</span>;</span><br><span class="line">    client_max_body_size <span class="number">4</span>G;</span><br><span class="line"></span><br><span class="line">    server_name localhost;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">      proxy_set_header Host $http_host;</span><br><span class="line">      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">      proxy_redirect off;</span><br><span class="line">      proxy_buffering off;</span><br><span class="line">      proxy_pass http:<span class="comment">//aiohttp;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location /<span class="keyword">static</span> &#123;</span><br><span class="line">      # path for static files</span><br><span class="line">      root /var/www/aio_ooad/<span class="keyword">static</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  upstream aiohttp &#123;</span><br><span class="line">    # fail_timeout=0 means we always retry an upstream even if it failed</span><br><span class="line">    # to return a good HTTP response</span><br><span class="line"></span><br><span class="line">    # Unix domain servers</span><br><span class="line">    server unix:/var/www/aio_ooad/example_1.sock fail_timeout=<span class="number">0</span>;</span><br><span class="line">    server unix:/var/www/aio_ooad/example_2.sock fail_timeout=<span class="number">0</span>;</span><br><span class="line">    server unix:/var/www/aio_ooad/example_3.sock fail_timeout=<span class="number">0</span>;</span><br><span class="line">    server unix:/var/www/aio_ooad/example_4.sock fail_timeout=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    # Unix domain sockets are used in this example due to their high performance,</span><br><span class="line">    # but TCP/IP sockets could be used instead:</span><br><span class="line">    # server 127.0.0.1:8081 fail_timeout=0;</span><br><span class="line">    # server 127.0.0.1:8082 fail_timeout=0;</span><br><span class="line">    # server 127.0.0.1:8083 fail_timeout=0;</span><br><span class="line">    # server 127.0.0.1:8084 fail_timeout=0;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面大部分内容都是常规的</p>
<p>指明静态文件路径 nginx提供静态文件的支持是很快的 这是选择nginx部署的原因之一<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location /<span class="keyword">static</span> &#123;</span><br><span class="line">  # path for static files</span><br><span class="line">  root /var/www/aio_ooad/<span class="keyword">static</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>选择使用unix domian sockets文件的方式设置upstream 下面的注释也说到也可以使用TCP/IP sockets的方式 但是unix domain socket效果更好 一共配置了四个sockets文件 意味着后台一共有四个web app实例可以供nginx轮询选择<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">upstream aiohttp &#123;</span><br><span class="line">  # fail_timeout=0 means we always retry an upstream even if it failed</span><br><span class="line">  # to return a good HTTP response</span><br><span class="line"></span><br><span class="line">  # Unix domain servers</span><br><span class="line">  server unix:/var/www/aio_ooad/example_1.sock fail_timeout=<span class="number">0</span>;</span><br><span class="line">  server unix:/var/www/aio_ooad/example_2.sock fail_timeout=<span class="number">0</span>;</span><br><span class="line">  server unix:/var/www/aio_ooad/example_3.sock fail_timeout=<span class="number">0</span>;</span><br><span class="line">  server unix:/var/www/aio_ooad/example_4.sock fail_timeout=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  # Unix domain sockets are used in this example due to their high performance,</span><br><span class="line">  # but TCP/IP sockets could be used instead:</span><br><span class="line">  # server 127.0.0.1:8081 fail_timeout=0;</span><br><span class="line">  # server 127.0.0.1:8082 fail_timeout=0;</span><br><span class="line">  # server 127.0.0.1:8083 fail_timeout=0;</span><br><span class="line">  # server 127.0.0.1:8084 fail_timeout=0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="supervisor配置"><a href="#supervisor配置" class="headerlink" title="supervisor配置"></a>supervisor配置</h2><ul>
<li>supervisor默认配置文件 /etc/supervisor/supervisord.conf</li>
<li>部署项目的配置文件 /etc/supervisor/conf.d/example.ini</li>
</ul>
<p>修改/etc/supervisor/supervisord.conf 最后一行处为<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[include]</span><br><span class="line">files = conf.d<span class="comment">/*.ini    ;</span></span><br></pre></td></tr></table></figure></p>
<p>/etc/supervisor/conf.d/example.ini<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[program:aiohttp]</span><br><span class="line">numprocs = <span class="number">4</span></span><br><span class="line">numprocs_start = <span class="number">1</span></span><br><span class="line">process_name = example_%(process_num)s</span><br><span class="line"></span><br><span class="line">; Unix socket paths are specified by command line.</span><br><span class="line">command=python3.6 /var/www/aio_ooad/test_main.py --path=/var/www/aio_ooad/example_%(process_num)s.sock --port=<span class="number">808</span>%(process_num)s</span><br><span class="line"></span><br><span class="line">; We can just as easily pass TCP port numbers:</span><br><span class="line">; command=/path/to/aiohttp_example.py --port=<span class="number">808</span>%(process_num)s</span><br><span class="line"></span><br><span class="line">user=www-data</span><br><span class="line">autostart=<span class="keyword">true</span></span><br><span class="line">autorestart=<span class="keyword">true</span></span><br></pre></td></tr></table></figure></p>
<pre><code>numprocs = 4
numprocs_start = 1
process_name = example_%(process_num)s
</code></pre><p>一共四个进程 进程号从1到4 进程名字由进程号决定 则为example_1 example_2 example_3 example_4</p>
<pre><code>command=python3.6 /var/www/aio_ooad/test_main.py --path=/var/www/aio_ooad/example_%(process_num)s.sock --port=808%(process_num)s
user=www-data
</code></pre><p>后台运行此命令 也即是运行web app所在的py文件 执行用户为www-data</p>
<p>这里坑就比较多了</p>
<p>1.python模块问题<br>因为supervisor是由root用户运行的 所以在supervisor里面后台执行python命令也是在root用户下执行的</p>
<p>正如我开始所说 我一直依赖都是windows系统下进行开发的 对权限的意识不是很足</p>
<p>下面我们来看看一个模块安装问题<br>因为我是使用普通用户gzm进行安装aiohttp模块的 但是在部署之后日志显示没有安装aiohttp模块</p>
<p>让我们在普通用户gzm下打开python3终端 查看模块安装目录<br><img src="http://static.zybuluo.com/gzm1997/61hncydvbdnd2cwdkcofcks8/image_1cff2k7ie1nqkpra1a7t1pp81e0q2m.png" alt="image_1cff2k7ie1nqkpra1a7t1pp81e0q2m.png-40kB"><br>我们会发现里面有个路径为</p>
<pre><code>/home/gzm/.local/lib/python3.6/site-packages
</code></pre><p>进入之后发现aiohttp正是安装在这个路径下面<br><img src="http://static.zybuluo.com/gzm1997/npxy5oetqeztqsxq16xr4t4b/image_1cff2pkee1quh1kbssklugl167p33.png" alt="image_1cff2pkee1quh1kbssklugl167p33.png-66kB"></p>
<p>然后让我们切换为root用户 查看模块安装路径 发现没有/home/gzm/.local/lib/python3.6/site-packages 这个路径 这就解释了为什么即使我真的在gzm这个用户下安装了aiohttp等模块 但是运行supervisor还是会在日志中报错没有此模块 所以正确的方式是切换到root安装需要的模块<br><img src="http://static.zybuluo.com/gzm1997/clvu614mas8hh45xfdoxsgh3/image_1cff2sipucq2gtm1qid5141fvd4g.png" alt="image_1cff2sipucq2gtm1qid5141fvd4g.png-40.1kB"></p>
<p>还有一个问题是</p>
<pre><code>--path=/var/www/aio_ooad/example_%(process_num)s.sock
</code></pre><p>意味着www-data用户需要在/var/www/aio_ooad目录下创建四个.socket文件 以支持nginx 所以/var/www/aio_ooad这个文件需要把所有权改为www-data 不然会在日志中报错permission denied</p>
<pre><code>sudo chown -R www-data:www-data /var/www/aio_ooad/
</code></pre><hr>
<h2 id="web-app所在py"><a href="#web-app所在py" class="headerlink" title="web app所在py"></a>web app所在py</h2><p>test_main.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> aiohttp_polls <span class="keyword">import</span> main</span><br><span class="line"><span class="keyword">from</span> aiohttp <span class="keyword">import</span> web</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser(description=<span class="string">"aiohttp server example"</span>)</span><br><span class="line">parser.add_argument(<span class="string">'--path'</span>)</span><br><span class="line">parser.add_argument(<span class="string">'--port'</span>)</span><br><span class="line"></span><br><span class="line">app = main.app</span><br><span class="line">args = parser.parse_args()</span><br><span class="line">web.run_app(app, host=<span class="string">"0.0.0.0"</span>, port=args.port, path=args.path)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="nginx-supervisor重启命令"><a href="#nginx-supervisor重启命令" class="headerlink" title="nginx supervisor重启命令"></a>nginx supervisor重启命令</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/nginx restart</span><br><span class="line">sudo supervisorctl reload</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/06/08/nginx-supervisor部署aiohttp/" data-id="cjqjgkv5v0011qco061dguvli" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aiohttp/">aiohttp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/deploy/">deploy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ubuntu/">ubuntu</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-java-socket编程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/08/java-socket编程/" class="article-date">
  <time datetime="2018-06-08T07:14:26.000Z" itemprop="datePublished">2018-06-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/08/java-socket编程/">java socket编程</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>java的socket编程跟python的很像 而且也很方便 简单记录一下 同时server那边的accept也是阻塞的</p>
</blockquote>
<p>connect函数可以在初始化一个socket对象之后 一般客户端可以用来链接服务端 但是如果在socket构造函数那里传入serverName和port 也是可以在初始化的时候进行连接的</p>
<p>服务端<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JServer</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ServerSocket server;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">JServer</span><span class="params">(<span class="keyword">int</span> port)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        server = <span class="keyword">new</span> ServerSocket(port);</span><br><span class="line">        server.setSoTimeout(<span class="number">10000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">"等待客户端连接"</span>);</span><br><span class="line">                Socket s = server.accept();</span><br><span class="line">                System.out.println(<span class="string">"远程连接地址 "</span> + s.getRemoteSocketAddress());</span><br><span class="line">                DataInputStream in = <span class="keyword">new</span> DataInputStream(s.getInputStream());</span><br><span class="line">                System.out.println(<span class="string">"接受数据"</span> + in.readUTF());</span><br><span class="line">                DataOutputStream out = <span class="keyword">new</span> DataOutputStream(s.getOutputStream());</span><br><span class="line">                out.writeUTF(<span class="string">"我接收到了 拜拜"</span>);</span><br><span class="line">                s.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException i) &#123;</span><br><span class="line">                i.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        JServer JS = <span class="keyword">new</span> JServer(<span class="number">5000</span>);</span><br><span class="line">        JS.run();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>客户端<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JClient</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Socket client;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">JClient</span><span class="params">(String serverName, <span class="keyword">int</span> port)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        client = <span class="keyword">new</span> Socket(serverName, port);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"现在开始连接服务端"</span>);</span><br><span class="line">            DataOutputStream out = <span class="keyword">new</span> DataOutputStream(client.getOutputStream());</span><br><span class="line">            out.writeUTF(<span class="string">"我是客户端 服务端你那边接收到我发的信息了没"</span>);</span><br><span class="line">            DataInputStream in = <span class="keyword">new</span> DataInputStream(client.getInputStream());</span><br><span class="line">            System.out.println(<span class="string">"从服务端接受到 "</span> + in.readUTF());</span><br><span class="line">            client.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException i) &#123;</span><br><span class="line">            i.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        JClient client = <span class="keyword">new</span> JClient(<span class="string">"127.0.0.1"</span>, <span class="number">5000</span>);</span><br><span class="line">        client.run();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>结果<br><img src="http://static.zybuluo.com/gzm1997/wqhihdmobujgo1q0qhkowxzu/image_1cf7fbt5l1flia2gpmn1bp1328p.png" alt="image_1cf7fbt5l1flia2gpmn1bp1328p.png-192.9kB"><br><img src="http://static.zybuluo.com/gzm1997/n2xnec3oqf70wxtjzugqpfjs/image_1cf7fcgan62o1ict1n4lvbbda16.png" alt="image_1cf7fcgan62o1ict1n4lvbbda16.png-160.3kB"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/06/08/java-socket编程/" data-id="cjqjgkv5r000wqco0vbx8s680" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/socket/">socket</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-java基础知识" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/04/java基础知识/" class="article-date">
  <time datetime="2018-06-04T06:33:06.000Z" itemprop="datePublished">2018-06-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/04/java基础知识/">java基础知识</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>gzm keep patient</p>
<hr>
<h2 id="java和编译型语言区别"><a href="#java和编译型语言区别" class="headerlink" title="java和编译型语言区别"></a>java和编译型语言区别</h2><p><img src="http://www.runoob.com/wp-content/uploads/2013/12/ZSSDMld.png" alt="此处输入图片的描述"><br>编译型语言直接编译变为可执行程序exe，然后就可以执行了。但是java需要先编译为.class字節碼，在由解釋器進行解釋執行。可以說java是介於編譯型語言和解釋型語言之間的一鍾語言了。所以網上一直有種說法：最好不要使用編譯型語言和解釋型語言的劃分方法來劃分java，因爲它既有編譯，也有解釋。</p>
<p><img src="http://static.zybuluo.com/gzm1997/j59t84gedmf9aeiomjy15n6z/image_1cer6l3dg1ma768a1egjb8d7671g.png" alt="image_1cer6l3dg1ma768a1egjb8d7671g.png-2.5kB"></p>
<hr>
<h2 id="各种类型变量存储位置"><a href="#各种类型变量存储位置" class="headerlink" title="各种类型变量存储位置"></a>各种类型变量存储位置</h2><p>局部变量 -&gt; 栈<br>动态变量 -&gt; 堆<br>全局变量 静态变量 -&gt; 静态存储区<br>函数代码 -&gt; 代码区<br>常量 -&gt; 常量区</p>
<hr>
<h2 id="java支持的变量类型"><a href="#java支持的变量类型" class="headerlink" title="java支持的变量类型"></a>java支持的变量类型</h2><p>类中的变量类型</p>
<ul>
<li>类变量 独立于方法之外的变量 static修饰 每个类共享</li>
<li>实例变量 独立于方法之外 但是没有static修饰 每个实例都有自己的一个这个变量的版本 实例变量具有默认值。数值型变量的默认值是0，布尔型变量的默认值是false，引用类型变量的默认值是null 变量的值可以在声明时指定，也可以在构造方法中指定</li>
<li>局部变量 类方法中的变量 <strong>访问修饰符可以修饰实例变量</strong></li>
</ul>
<p>局部变量</p>
<ul>
<li>声明在方法、构造方法或者语句块中</li>
<li>访问修饰符不能用于局部变</li>
<li>局部变量是没有默认值 所有被声明之后需要初始化之后才可以使用</li>
</ul>
<hr>
<p>final修饰变量</p>
<p><strong>final</strong> 变量能被显式地初始化并且只能初始化一次。被声明为 final 的对象的引用不能指向不同的对象。但是 final 对象里的数据可以被改变。也就是说 final 对象的引用不能改变，但是里面的值可以改变</p>
<p>final修饰类中的方法<br>类中的 final 方法可以被子类继承，但是不能被子类修改。</p>
<p>final修饰类<br>final修饰的类不能被继承 没有类能继承final类的任何特性</p>
<hr>
<h2 id="abstract修饰符"><a href="#abstract修饰符" class="headerlink" title="abstract修饰符"></a>abstract修饰符</h2><blockquote>
<p>abstract抽象类是不能用来实例化对象的 声明抽象类的唯一目的就是将来对该类进行扩充 </p>
</blockquote>
<p>如果一个类中具有抽象方法 那么这个类一定要声明微抽象类 抽象方法的的定义由子类提供</p>
<p><strong>任何继承抽象类的子类必须实现父类的所有抽象方法，除非该子类也是抽象类。</strong></p>
<p>abstract抽象类例子<br>Test.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Mon_class</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">m</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son_class</span> <span class="keyword">extends</span> <span class="title">Mon_class</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"this is a m func"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String []args)</span> </span>&#123;</span><br><span class="line">        Son_class test_class = <span class="keyword">new</span> Son_class();</span><br><span class="line">        test_class.m();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>可以使用非抽象子类的构造函数创建一个抽象父类的引用对象 并且可以调用具体定义在非抽象子类中的重写方法<br>但是注意非抽象类的构造函数并不可以用来创建一个实例</p>
<hr>
<h2 id="synchronized-修饰符"><a href="#synchronized-修饰符" class="headerlink" title="synchronized 修饰符"></a>synchronized 修饰符</h2><p>synchronized 关键字声明的方法同一时间只能被一个线程访问。synchronized 修饰符可以应用于四个访问修饰符。</p>
<hr>
<h2 id="transient-修饰符"><a href="#transient-修饰符" class="headerlink" title="transient 修饰符"></a>transient 修饰符</h2><p>序列化的对象包含被 transient修饰的实例变量时，java虚拟机(JVM)跳过该特定的变量。<br>该修饰符包含在定义变量的语句中，用来预处理类和变量的数据类型。</p>
<hr>
<h2 id="volatile-修饰符"><a href="#volatile-修饰符" class="headerlink" title="volatile 修饰符"></a>volatile 修饰符</h2><p>volatile 修饰的成员变量在每次被线程访问时，都强制从共享内存中重新读取该成员变量的值。而且，当成员变量发生变化时，会强制线程将变化值回写到共享内存。这样在任何时刻，两个不同的线程总是看到某个成员变量的同一个值。</p>
<p>一个 volatile 对象引用可能是 null。</p>
<hr>
<h2 id="extends和implements"><a href="#extends和implements" class="headerlink" title="extends和implements"></a>extends和implements</h2><ol>
<li>在类的声明中，通过关键字extends来创建一个类的子类。一个类通过关键字implements声明自己使用一个或者多个接口。<br>extends 是继承某个类, 继承之后可以使用父类的方法, 也可以重写父类的方法; implements 是实现多个接口, 接口的方法一般为空的, 必须重写才能使用<br>2.extends是继承父类，只要那个类不是声明为final或者那个类定义为abstract的就能继承，JAVA中不支持多重继承，但是可以用接口 来实现，这样就要用到implements，继承只能继承一个类，但implements可以实现多个接口，用逗号分开就行了</li>
</ol>
<hr>
<h2 id="instanceof运算符"><a href="#instanceof运算符" class="headerlink" title="instanceof运算符"></a>instanceof运算符</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String []args)</span> </span>&#123;</span><br><span class="line">        String name = <span class="string">"gzm"</span>;</span><br><span class="line">        System.out.println(name <span class="keyword">instanceof</span> String);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="装箱和拆箱"><a href="#装箱和拆箱" class="headerlink" title="装箱和拆箱"></a>装箱和拆箱</h2><p>在java中的内置数据类型对应的包装类都是继承一个叫做Number的抽象类的，关系图如下<br><img src="http://static.zybuluo.com/gzm1997/ju6g8b2cnhyoxnqdx8a1iprz/image_1cetpi31q1ldo12bi1f1l1i841aru9.png" alt="image_1cetpi31q1ldo12bi1f1l1i841aru9.png-43.3kB"></p>
<ul>
<li>当内置数据类型被当作对象使用的时候 编译器会吧内置类型装箱</li>
<li>反过来 编译器也会一个包装类拆箱</li>
</ul>
<p>比如下面是整型包装类和内置类型之间的装箱和拆箱之间的关系<br><img src="http://static.zybuluo.com/gzm1997/dykem4xmjm8n3tzgk0zlk8c1/image_1cetputrjfl1t58lp7o0g1a8m.png" alt="image_1cetputrjfl1t58lp7o0g1a8m.png-3kB"></p>
<p>例子<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String []args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//装箱</span></span><br><span class="line">        Integer num = <span class="number">5</span>;</span><br><span class="line">        <span class="comment">//拆箱</span></span><br><span class="line">        num += <span class="number">10</span>;</span><br><span class="line">        System.out.println(<span class="string">"num "</span> + num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="Charactor"><a href="#Charactor" class="headerlink" title="Charactor"></a>Charactor</h2><p>char这个内置数据类型对应的包装类是Charactor</p>
<hr>
<h2 id="String和char-array"><a href="#String和char-array" class="headerlink" title="String和char array"></a>String和char array</h2><p>String和char array的相互转换以及遍历<br>String转为char array<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String t_str = <span class="string">"abcd"</span>;</span><br><span class="line"><span class="keyword">char</span> [] c_arr = t_str.toCharArray();</span><br></pre></td></tr></table></figure></p>
<p>char array转为String<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String new_str = <span class="keyword">new</span> String(c_arr);</span><br></pre></td></tr></table></figure></p>
<p>foreach只可以用来迭代可迭代对象 String并不是可迭代对象 只有char array是可迭代对象<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">char</span> c: c_arr</span><br><span class="line">     ) &#123;</span><br><span class="line">    System.out.println(c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">char</span> c: <span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>&#125;</span><br><span class="line">     ) &#123;</span><br><span class="line">    System.out.println(c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>String类是不可该改变的 即使具有concat那些字符串连接方法 但是那也是新建了一个新的String对象 如果需要改变字符串 那么就需要使用StringBuffer和StringBuilder对象了</p>
<ul>
<li>String 不可修改 速度最慢</li>
<li>StringBuffer 可修改 速度中等 线程安全</li>
<li>StringBuilder 可修改 速度最快 非线程安全</li>
</ul>
<p>StringBuffer基本使用<br>(注意在insert和replace这些函数中 start end的范围是跟python是相同 都是包含start但是没有包含end)<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span> <span class="params">(String []args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        StringBuffer test_buffer = <span class="keyword">new</span> StringBuffer(<span class="string">"lala"</span>);</span><br><span class="line">        test_buffer.append(<span class="string">"heihei"</span>);</span><br><span class="line">        System.out.println(test_buffer);</span><br><span class="line">        test_buffer.reverse();</span><br><span class="line">        System.out.println(test_buffer);</span><br><span class="line">        test_buffer.delete(test_buffer.length() - <span class="number">3</span>, test_buffer.length());</span><br><span class="line">        System.out.println(test_buffer);</span><br><span class="line">        test_buffer.replace(<span class="number">1</span>, <span class="number">2</span>, <span class="string">"heihei"</span>);</span><br><span class="line">        System.out.println(test_buffer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="StringBuilder"><a href="#StringBuilder" class="headerlink" title="StringBuilder"></a>StringBuilder</h2><p>如果在StringBilder的构造函数中没有传入一个长度参数，那么这个构造函数将会为这个StringBuilder分配默认的16个字符的空间</p>
<hr>
<p>什么是内存抖动Memory Churn<br>内存抖动是因为大量对象被创建又在段时间内马上被释放 内存页被频繁更换 导致整个系统效率急剧下降 这个现象称为内存抖动 一般都是因为内存分配算法不好 内存太小造成的<br><strong>其实内存抖动就是系统颠簸</strong></p>
<hr>
<h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><p>基本使用<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String content = <span class="string">"i am haha"</span>;</span><br><span class="line">String patern = <span class="string">".*haha"</span>;</span><br><span class="line">System.out.println(Pattern.matches(patern, content));</span><br></pre></td></tr></table></figure></p>
<p>常用的正则表达</p>
<ul>
<li>.表示任意一个字符</li>
<li>\s+表示若干个空格(应该是1个或者多个)</li>
<li>\d+表示一个或者多个数字</li>
<li>\.表示.</li>
<li>()?表示问好前面中的括号的内容是可选的</li>
<li>{n} n为非负数 表示前面的字符刚好重复n次</li>
<li>{n，} n为非负数 表示前面的字符至少重复n次</li>
<li>{n，m} n为非负数 表示前面的字符出现次数至少n次 之多m次</li>
<li>x|y 匹配x或者y</li>
<li>[xyz]匹配xyz中任一字符</li>
<li>[^xyz] 跟上面的相反 匹配不是xyz的字符</li>
<li>[a-z] 字符范围 匹配a-z之间的字符</li>
<li>[^a-z]反向范围</li>
<li>\b匹配一个字符边界(字符和空格间的位置) 例如，”er\b”匹配”never”中的”er”，但不匹配”verb”中的”er”。</li>
<li>\B匹配一个非字符边界 “er\B”匹配”verb”中的”er”，但不匹配”never”中的”er”。</li>
</ul>
<hr>
<h2 id="java可变参数"><a href="#java可变参数" class="headerlink" title="java可变参数"></a>java可变参数</h2><p>从jdk1.5开始 java支持传递同类型的可变参数 这个跟声明参数为数组类型的不同的地方在于可以传入多个同类型的参数</p>
<p>声明方式</p>
<pre><code>typeName... parameterName
</code></pre><p>例子：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testPrint</span><span class="params">(<span class="keyword">int</span>... arr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (arr.length == <span class="number">0</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"no parameter has been transfer"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i: arr</span><br><span class="line">             ) &#123;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String []args)</span> </span>&#123;</span><br><span class="line">        testPrint(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">        testPrint(<span class="keyword">new</span> <span class="keyword">int</span>[] &#123;<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="收尾机制finalize"><a href="#收尾机制finalize" class="headerlink" title="收尾机制finalize"></a>收尾机制finalize</h2><p>例子<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Object</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    Dog(<span class="keyword">int</span> _id) &#123;</span><br><span class="line">        id = _id;</span><br><span class="line">        System.out.printf(<span class="string">"id %d dog is create\n"</span>, id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">finalize</span><span class="params">()</span> <span class="keyword">throws</span> java.lang.Throwable </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.finalize();</span><br><span class="line">        System.out.printf(<span class="string">"id %d dog is dispose\n"</span>, id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String []args)</span> </span>&#123;</span><br><span class="line">        Dog d1 = <span class="keyword">new</span> Dog(<span class="number">1</span>);</span><br><span class="line">        Dog d2 = <span class="keyword">new</span> Dog(<span class="number">2</span>);</span><br><span class="line">        <span class="comment">//Dog d3 = new Dog(3);</span></span><br><span class="line">        <span class="comment">//d1 = null;</span></span><br><span class="line">        <span class="comment">//System.gc();</span></span><br><span class="line">        d1 = d2 = <span class="keyword">null</span>;</span><br><span class="line">        System.gc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="java-io"><a href="#java-io" class="headerlink" title="java io"></a>java io</h2><p>从控制台中输入一个字符<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String []args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">        <span class="keyword">int</span> r = br.read();</span><br><span class="line">        <span class="keyword">char</span> c = (<span class="keyword">char</span>) r;</span><br><span class="line">        System.out.println(c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在控制台中输入一个字符串 也是使用Bufferreader这个对象进行读取 但是是使用readline这个函数进行读取<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String []args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">        String r = br.readLine();</span><br><span class="line">        System.out.println(r);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>可以解决中文输入输出出现乱码都解决方法<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        File f = <span class="keyword">new</span> File(<span class="string">"a.txt"</span>);</span><br><span class="line">        FileOutputStream fop = <span class="keyword">new</span> FileOutputStream(f);</span><br><span class="line">        <span class="comment">// 构建FileOutputStream对象,文件不存在会自动新建</span></span><br><span class="line"></span><br><span class="line">        OutputStreamWriter writer = <span class="keyword">new</span> OutputStreamWriter(fop, <span class="string">"UTF-8"</span>);</span><br><span class="line">        <span class="comment">// 构建OutputStreamWriter对象,参数可以指定编码,默认为操作系统默认编码,windows上是gbk</span></span><br><span class="line"></span><br><span class="line">        writer.append(<span class="string">"中文输入"</span>);</span><br><span class="line">        <span class="comment">// 写入到缓冲区</span></span><br><span class="line"></span><br><span class="line">        writer.append(<span class="string">"\r\n"</span>);</span><br><span class="line">        <span class="comment">//换行</span></span><br><span class="line"></span><br><span class="line">        writer.append(<span class="string">"English"</span>);</span><br><span class="line">        <span class="comment">// 刷新缓存冲,写入到文件,如果下面已经没有写入的内容了,直接close也会写入</span></span><br><span class="line"></span><br><span class="line">        writer.close();</span><br><span class="line">        <span class="comment">//关闭写入流,同时会把缓冲区内容写入文件,所以上面的注释掉</span></span><br><span class="line"></span><br><span class="line">        fop.close();</span><br><span class="line">        <span class="comment">// 关闭输出流,释放系统资源</span></span><br><span class="line"></span><br><span class="line">        FileInputStream fip = <span class="keyword">new</span> FileInputStream(f);</span><br><span class="line">        <span class="comment">// 构建FileInputStream对象</span></span><br><span class="line"></span><br><span class="line">        InputStreamReader reader = <span class="keyword">new</span> InputStreamReader(fip, <span class="string">"UTF-8"</span>);</span><br><span class="line">        <span class="comment">// 构建InputStreamReader对象,编码与写入相同</span></span><br><span class="line"></span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        <span class="keyword">while</span> (reader.ready()) &#123;</span><br><span class="line">            sb.append((<span class="keyword">char</span>) reader.read());</span><br><span class="line">            <span class="comment">// 转成char加到StringBuffer对象中</span></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sb.toString());</span><br><span class="line">        reader.close();</span><br><span class="line">        <span class="comment">// 关闭读取流</span></span><br><span class="line"></span><br><span class="line">        fip.close();</span><br><span class="line">        <span class="comment">// 关闭输入流,释放系统资源</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="Scanner"><a href="#Scanner" class="headerlink" title="Scanner"></a>Scanner</h2><p>Scanner是java5的新特征 可以通过Scanner类来获取输入的字符串或者数字 字符</p>
<p>下面是获取输入字符串的例子<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String []args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">if</span> (s.hasNext()) &#123;</span><br><span class="line">            String r = s.next();</span><br><span class="line">            System.out.println(r);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Scanner s1 = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">if</span> (s1.hasNextLine()) &#123;</span><br><span class="line">            String r = s1.nextLine();</span><br><span class="line">            System.out.println(r);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">`</span><br></pre></td></tr></table></figure></p>
<p>next和nextLine的区别<br>next</p>
<ol>
<li>一定要读取到有效字符后才可以结束输入。</li>
<li>对输入有效字符之前遇到的空白，next()方法会自动将其去掉。</li>
<li>只有输入有效字符后才将其后面输入的空白作为分隔符或者结束符。</li>
<li>next() 不能得到带有空格的字符串。</li>
</ol>
<p>nextLine</p>
<ol>
<li>以Enter为结束符,也就是说 nextLine()方法返回的是输入回车之前的所有字符。</li>
<li>可以获得空白。</li>
</ol>
<hr>
<h2 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h2><p><img src="http://static.zybuluo.com/gzm1997/53k55dvgsec69ejiu8eweqzx/image_1cf08i4nf1ifd1qtm12hfuoa1lu9.png" alt="image_1cf08i4nf1ifd1qtm12hfuoa1lu9.png-24.4kB"></p>
<hr>
<h2 id="继承和接口"><a href="#继承和接口" class="headerlink" title="继承和接口"></a>继承和接口</h2><blockquote>
<p>java的继承是单继承 就是说一个子类只可以有一个父类 同时java是支持多重继承的 就是说c可以继承b b继承a 这就是多重继承</p>
</blockquote>
<p>但是java也是可以通过interface来实现多重继承的<br>例子<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A_test</span> <span class="keyword">implements</span> <span class="title">A</span>, <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"this is eat func"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"this is sleep func"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String []args)</span> </span>&#123;</span><br><span class="line">        A_test test_a = <span class="keyword">new</span> A_test();</span><br><span class="line">        test_a.eat();</span><br><span class="line">        test_a.sleep();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>值得一提的是 接口也可以初始化实例 并且这些接口初始化出来的实例也可以调用它们的方法 即使这些方法的定义在implements了它们的class中</p>
<hr>
<h2 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h2><blockquote>
<p>java的子类是不能继承夫类的构造函数的 但是当父类的构造函数含有参数时候 必须在子类的构造函数中使用super关键字调用父类构造函数 并且传入参数<br>但是当父类的构造函数没有参数 子类不是必须super调用父类构造函数的 因为系统会自动调用父类的无参构造函数</p>
</blockquote>
<hr>
<h2 id="继承中的引用对象"><a href="#继承中的引用对象" class="headerlink" title="继承中的引用对象"></a>继承中的引用对象</h2><p>可以使用</p>
<ul>
<li>子类的构造函数构造父类的引用对象</li>
<li>不可以使用父类的构造函数构造子类的引用对象</li>
</ul>
<p>如果使用的是子类的构造函数来构造父类的引用对象 那么这个对象调用的函数版本是子类中重写的版本</p>
<hr>
<h2 id="override和overload"><a href="#override和overload" class="headerlink" title="override和overload"></a>override和overload</h2><p>重写</p>
<ul>
<li>重写是在子类和父类之间的</li>
<li>重写的参数列表和返回类型必须相同</li>
<li>声明微final的方法不可以被重写</li>
<li>构造方法不可以被重写</li>
<li>static方法不可以被重写 但是可以被重新声明</li>
</ul>
<p>子类和父类都具有相同的static的的同名 同参数列表 同返回类型的函数 但是<strong>这不是重写 static函数不可以被重写 这是重新声明</strong></p>
<p>static函数被重新声明的时候<br>无论父类的引用对象是被父类构造函数还是子类构造函数构造的 它调用的版本都是父类的static函数版本</p>
<p>子类的引用对象调用的版本是自己重新声明的static版本</p>
<p>例子<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">move</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"animal is move"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testStatic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"this is animal static func"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">move</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Dog is move"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testStatic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"this is a Dog static funcss"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">         Animal a = <span class="keyword">new</span> Animal();</span><br><span class="line">         Animal b = <span class="keyword">new</span> Dog();</span><br><span class="line">         a.testStatic();</span><br><span class="line">         b.testStatic();</span><br><span class="line">         Dog c = <span class="keyword">new</span> Dog();</span><br><span class="line">         c.testStatic();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出<br><img src="http://static.zybuluo.com/gzm1997/7lvemg4vbu261q3dcd98zx1z/image_1cf49j0l51m6jpbfaqp4h6f219.png" alt="image_1cf49j0l51m6jpbfaqp4h6f219.png-8.3kB"></p>
<p>重载</p>
<ul>
<li>在通一个class中</li>
<li>返回类型 函数名 参数列表相同</li>
</ul>
<hr>
<h2 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h2><p>多态是建立在上面的方法重写之上的 被重写的方法称为虚方法</p>
<p>多态的编译和运行</p>
<p>使用子类引用子类的对象 </p>
<ul>
<li>在编译的时候编译器会在子类中找到相应的方法 然后执行的时候JVM会调用子类的这个方法</li>
</ul>
<p>使用父类引用子类的对象</p>
<ul>
<li>在编译时 编译器会使用父类的虚方法进行验证 但是在运行时 JVM调用的是子类的对应的虚方法</li>
</ul>
<p>java的所有方法都按照这种方式来实现 因此<strong>重写方法能在运行时调用</strong> 不敢编译的时候源代码中引用变量是什么数据类型</p>
<p> 多态的实现方式</p>
<ul>
<li>重写</li>
<li>接口</li>
</ul>
<p>我一直以为重写是实现多态的唯一方式 但是java里面接口也是实现多态的一种方式 比如上面的多态内容中 我不是发现使用implements了接口的类构造函数类来创建一个interface引用对象 并且可以调用实现方法在这个class中的方法 所以这也是实现多态的一种方式</p>
<p>例子<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">move</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">implements</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">move</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"this is move func in Dog"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        A testA = <span class="keyword">new</span> Dog();</span><br><span class="line">        testA.move();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注意 interface没有构造函数 因为根本不能用以实例化一个对象</p>
<hr>
<h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><p>interface特性</p>
<ul>
<li>每个接口的方法都隐士指定为public abstract 其他修饰符都会报错</li>
<li>接口中可以有变量到 都会被隐士指定为public static final 使用private修饰编译会报错</li>
<li>接口的方法不能在接口中实现 只能由实现接口的类来实现</li>
<li>接口可以继承 这个跟类的继承相似 但是类只支持多重继承 不支持多继承 接口的继承支持多继承也支持多重继承</li>
</ul>
<p>标记接口</p>
<blockquote>
<p>最常用的继承接口是没有包含任何方法的接口和属性的 这个叫做<strong>标记接口</strong> 主要是表明它的类属于一个特定的类型</p>
</blockquote>
<p>目的</p>
<ul>
<li>建立一个公共的父接口 正如EventListener接口，这是由几十个其他接口扩展的Java API，你可以使用一个标记接口来建立一组接口的父接口。例如：当一个接口继承了EventListener接口，Java虚拟机(JVM)就知道该接口将要被用于一个事件的代理方案</li>
<li>向一个类添加数据类型 这种情况是标记接口最初的目的，实现标记接口的类不需要定义任何接口方法(因为标记接口根本就没有方法)，但是该类通过多态性变成一个接口类型</li>
</ul>
<hr>
<h2 id="包"><a href="#包" class="headerlink" title="包"></a>包</h2><blockquote>
<p>同一个包内的类命名是不可以相同的 但是不同包内的命名是可以相同的</p>
</blockquote>
<p>包例子：<br>结构如下</p>
<ul>
<li>animal<ul>
<li>Animal.java(Animal interface)</li>
<li>MammalInt.java(MammalInt class implements Animal)</li>
</ul>
</li>
<li>Test.java(import animal.MammalInt)</li>
</ul>
<p>Animal.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> animal;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>MammalInt.jav<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> animal;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MammalInt</span> <span class="keyword">implements</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"this is is animal eat func"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MammalInt testM = <span class="keyword">new</span> MammalInt();</span><br><span class="line">        testM.eat();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Test.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> animal.MammalInt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MammalInt testM = <span class="keyword">new</span> MammalInt();</span><br><span class="line">        testM.eat();</span><br><span class="line">        System.out.println(<span class="string">"this is test java file"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p> 运行Test.java<br> <img src="http://static.zybuluo.com/gzm1997/mz2rq84io7bbnj3v4814emzz/image_1cf4lkjqb6vtuc0f5ja2nc0kt.png" alt="image_1cf4lkjqb6vtuc0f5ja2nc0kt.png-7.7kB"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/06/04/java基础知识/" data-id="cjqjgkv61001aqco0kee5aswn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AVL树/">AVL树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ORM/">ORM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aiohttp/">aiohttp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/async/">async</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backend/">backend</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/beego/">beego</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cayley/">cayley</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cookies/">cookies</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cors/">cors</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/">database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deep-web/">deep web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deploy/">deploy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dgraph/">dgraph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask深入学习/">flask深入学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/graph/">graph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gremlin/">gremlin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hugegraph/">hugegraph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/image/">image</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mux/">mux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/package/">package</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rabbitMQ/">rabbitMQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/requests/">requests</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/servlet/">servlet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/session/">session</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/socket/">socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlalchemy/">sqlalchemy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/subgraph/">subgraph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图数据库/">图数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图算法/">图算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图谱/">图谱</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多线程/">多线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/红黑树/">红黑树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线程/">线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件开发生命周期/">软件开发生命周期</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AVL树/" style="font-size: 10px;">AVL树</a> <a href="/tags/ORM/" style="font-size: 10px;">ORM</a> <a href="/tags/aiohttp/" style="font-size: 16px;">aiohttp</a> <a href="/tags/async/" style="font-size: 14px;">async</a> <a href="/tags/backend/" style="font-size: 10px;">backend</a> <a href="/tags/beego/" style="font-size: 12px;">beego</a> <a href="/tags/cayley/" style="font-size: 16px;">cayley</a> <a href="/tags/cookies/" style="font-size: 10px;">cookies</a> <a href="/tags/cors/" style="font-size: 10px;">cors</a> <a href="/tags/database/" style="font-size: 14px;">database</a> <a href="/tags/deep-web/" style="font-size: 10px;">deep web</a> <a href="/tags/deploy/" style="font-size: 10px;">deploy</a> <a href="/tags/dgraph/" style="font-size: 10px;">dgraph</a> <a href="/tags/docker/" style="font-size: 12px;">docker</a> <a href="/tags/flask/" style="font-size: 10px;">flask</a> <a href="/tags/flask深入学习/" style="font-size: 10px;">flask深入学习</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/go/" style="font-size: 20px;">go</a> <a href="/tags/graph/" style="font-size: 10px;">graph</a> <a href="/tags/gremlin/" style="font-size: 10px;">gremlin</a> <a href="/tags/hugegraph/" style="font-size: 10px;">hugegraph</a> <a href="/tags/image/" style="font-size: 10px;">image</a> <a href="/tags/java/" style="font-size: 18px;">java</a> <a href="/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/tags/mux/" style="font-size: 10px;">mux</a> <a href="/tags/mysql/" style="font-size: 16px;">mysql</a> <a href="/tags/package/" style="font-size: 10px;">package</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/rabbitMQ/" style="font-size: 10px;">rabbitMQ</a> <a href="/tags/requests/" style="font-size: 10px;">requests</a> <a href="/tags/servlet/" style="font-size: 10px;">servlet</a> <a href="/tags/session/" style="font-size: 12px;">session</a> <a href="/tags/socket/" style="font-size: 10px;">socket</a> <a href="/tags/sqlalchemy/" style="font-size: 12px;">sqlalchemy</a> <a href="/tags/subgraph/" style="font-size: 10px;">subgraph</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/图数据库/" style="font-size: 12px;">图数据库</a> <a href="/tags/图算法/" style="font-size: 10px;">图算法</a> <a href="/tags/图谱/" style="font-size: 10px;">图谱</a> <a href="/tags/多线程/" style="font-size: 10px;">多线程</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a> <a href="/tags/红黑树/" style="font-size: 10px;">红黑树</a> <a href="/tags/线程/" style="font-size: 10px;">线程</a> <a href="/tags/软件开发生命周期/" style="font-size: 10px;">软件开发生命周期</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/01/05/java基础3：红黑树和AVL树/">java基础3：红黑树和AVL树</a>
          </li>
        
          <li>
            <a href="/2019/01/05/java基础2：树相关前哨/">java基础2：树相关前哨</a>
          </li>
        
          <li>
            <a href="/2018/12/24/ArrayList相关/">ArrayList相关</a>
          </li>
        
          <li>
            <a href="/2018/12/03/暑假学习总结/">暑假学习总结</a>
          </li>
        
          <li>
            <a href="/2018/12/03/subgraph概况/">subgraph概况</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 gzm1997<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
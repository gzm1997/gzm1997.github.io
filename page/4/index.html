<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>gzm&#39;s blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="gzm&#39;s blogs">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="gzm&#39;s blogs">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="gzm&#39;s blogs">
  
    <link rel="alternate" href="/atom.xml" title="gzm&#39;s blogs" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">gzm&#39;s blogs</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-aiohttp基本使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/26/aiohttp基本使用/" class="article-date">
  <time datetime="2018-05-25T16:45:53.000Z" itemprop="datePublished">2018-05-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/26/aiohttp基本使用/">aiohttp基本使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>这次系统分析与设计大作业我负责web后端开发工作，本来又想使用flask框架的，但是想想flask框架都有点审美疲劳了，而且flask框架是阻塞式框架，效率未免有点不高。所以这次我使用了异步web框架aiohttp，简单记录一下基本使用，至于框架原理之类后面再深入研究。</p>
</blockquote>
<p><a href="https://demos.aiohttp.org/en/latest/preparations.html" target="_blank" rel="noopener">官方文档</a></p>
<hr>
<h2 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h2><p>简单hello world代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> aiohttp <span class="keyword">import</span> web</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    app = web.Application()</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">(request)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> web.Response(text = <span class="string">"hello"</span>)</span><br><span class="line"></span><br><span class="line">    app.router.add_get(<span class="string">"/"</span>, hello)</span><br><span class="line">    web.run_app(app, port = <span class="number">5000</span>)</span><br></pre></td></tr></table></figure></p>
<p>在路由中添加视图函数<br>1.get</p>
<p>url例子： /<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.router.add_get(<span class="string">"/"</span>, hello)</span><br></pre></td></tr></table></figure></p>
<p>url例子： /api/order/3<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.router.add_get(<span class="string">"/api/order/&#123;id&#125;"</span>, reservation_view.get_order)</span><br></pre></td></tr></table></figure></p>
<p>使用以下获取参数id<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id = int(request.match_info[<span class="string">'id'</span>])</span><br></pre></td></tr></table></figure></p>
<p>url例子： /test?uuid=12<br>使用以下获取url参数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uuid = request.rel_url.query[<span class="string">'uuid'</span>]</span><br></pre></td></tr></table></figure></p>
<p>2.post</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.router.add_post(<span class="string">"/api/order"</span>, reservation_view.create_order)</span><br></pre></td></tr></table></figure>
<p>使用以下获取表单data<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="keyword">await</span> request.post()</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><blockquote>
<p>在这次系分的后端开发过程中，遇到了一个我以前也遇到过的问题，但是我忘记了以前我是怎么解决的了。问题就是，当post的表单中有一个value值为一个list，那么服务端这边接受会这样？</p>
</blockquote>
<p>上面的问题就是服务端这边接受了这个字典之后，会发现这个list的value值已经变形了，具体情况如下：<br>发送表单<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    session = requests.Session()</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">"table"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"list"</span>: [&#123;<span class="string">'id'</span>: <span class="string">'1'</span>, <span class="string">'name'</span>: <span class="string">'pork'</span>, <span class="string">'count'</span>: <span class="number">1</span>, <span class="string">'price'</span>: <span class="number">20</span>&#125;, &#123;<span class="string">'id'</span>: <span class="string">'2'</span>, <span class="string">'name'</span>: <span class="string">'fish'</span>, <span class="string">'count'</span>: <span class="number">1</span>, <span class="string">'price'</span>: <span class="number">23</span>&#125;]</span><br><span class="line">    &#125;</span><br><span class="line">    print(<span class="string">"data"</span>, data)</span><br><span class="line">    r = session.post(<span class="string">"http://127.0.0.1:5000/api/order"</span>, data = data)</span><br><span class="line">    print(<span class="string">"r"</span>, r)</span><br></pre></td></tr></table></figure></p>
<p>服务端接收为，很显然变形了<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;MultiDictProxy(<span class="string">'table'</span>: <span class="string">'1'</span>, <span class="string">'list'</span>: <span class="string">'id'</span>, <span class="string">'list'</span>: <span class="string">'name'</span>, <span class="string">'list'</span>: <span class="string">'count'</span>, <span class="string">'list'</span>: <span class="string">'price'</span>, <span class="string">'list'</span>: <span class="string">'id'</span>, <span class="string">'list'</span>: <span class="string">'name'</span>, <span class="string">'list'</span>: <span class="string">'count'</span>, <span class="string">'list'</span>: <span class="string">'price'</span>)&gt;</span><br></pre></td></tr></table></figure></p>
<p>然后我想到的解决方法就是将list这个value转为string类型再post过来，很显然或者解决方法很简单，问题就在于怎么在服务端这边从新将这个string解释为list对象，并且回复里面的字典。谷歌之后发现这样使用python的ast模块解决这个问题非常的方便</p>
<p>发送将list类型的value转为list之后的字典<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;</span><br><span class="line">    <span class="string">"table"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">"list"</span>: <span class="string">"[&#123;'id': '1', 'name': 'pork', 'count': 1, 'price': 20&#125;, &#123;'id': '2', 'name': 'fish', 'count': 1, 'price': 23&#125;]"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>服务端这边接受和解析<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="keyword">await</span> request.post()</span><br><span class="line">table_num = data[<span class="string">"table"</span>]</span><br><span class="line">food_list = ast.literal_eval(data[<span class="string">"list"</span>])</span><br></pre></td></tr></table></figure></p>
<p>这样就完美解决这个问题了，可能还有其他不修改list类型更好的方法，但是我觉得就不深究了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/26/aiohttp基本使用/" data-id="cjq20hc8y000myoo0cyrkwzut" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aiohttp/">aiohttp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/async/">async</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/backend/">backend</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-自制简易图片云盘" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/22/自制简易图片云盘/" class="article-date">
  <time datetime="2018-05-22T08:43:50.000Z" itemprop="datePublished">2018-05-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/22/自制简易图片云盘/">自制简易图片云盘</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://github.com/gzm1997/gallery" target="_blank" rel="noopener">github地址</a></p>
<hr>
<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>因为我经常在<strong>markdown</strong>书写过程中需要获取我一些图片或者截图的在线url，但是有些图片云盘需要收费或者要自己手动上传不方便。自己上传github固然可以，但是还是不够方便，所以写了个小脚本。</p>
<hr>
<h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><p><img src="https://raw.githubusercontent.com/gzm1997/gallery/master/mature/demo.gif" alt="demo"></p>
<hr>
<h2 id="需要"><a href="#需要" class="headerlink" title="需要"></a>需要</h2><ol>
<li>python</li>
<li>git</li>
<li>python依赖PIL</li>
</ol>
<hr>
<h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><ol>
<li>一开始需要把配图或者截图保存到本地(<strong>本地的git仓库中的raw文件夹</strong>)，不需要修改文件名。</li>
</ol>
<p><img src="https://raw.githubusercontent.com/gzm1997/gallery/master/mature/18.png" alt="文件结构"></p>
<hr>
<ol start="2">
<li>点击运行 <strong>run.cmd</strong> 文件</li>
</ol>
<p><img src="https://raw.githubusercontent.com/gzm1997/gallery/master/mature/20.png" alt="run.cmd"> </p>
<p>可以看见后面会输出这张图片的url，最后会提示你确认退出，其实这个确认退出只是为了<strong>造成阻塞</strong>，不然这个cmd文件运行完就自动关闭窗口不留时间给你复制url了。</p>
<hr>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>只用了一点点很简单的<strong>py</strong></p>
<ol>
<li><p>把保存在raw文件夹里面的图片复制到mature文件夹里面，并重命名(其实重命名不是必要的)，最后删除raw里面的原图片，最终返回这张图片的新名字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">def deliver_image():</span><br><span class="line">	raw = os.listdir(&quot;raw&quot;)</span><br><span class="line">	if raw == []:</span><br><span class="line">		return False</span><br><span class="line">	f = open(&quot;num.txt&quot;, &quot;rb&quot;)</span><br><span class="line">	num_str = f.read().decode(&quot;utf-8&quot;)</span><br><span class="line">	num = int(num_str)</span><br><span class="line">	f.close()</span><br><span class="line">	old_name = &quot;raw/&quot; + raw[0]</span><br><span class="line">	image_to_add = Image.open(old_name)</span><br><span class="line">	new_name = str(num + 1) + &quot;.png&quot;</span><br><span class="line">	image_to_add.save(&quot;mature/&quot; + new_name)</span><br><span class="line">	f = open(&quot;num.txt&quot;, &quot;wb&quot;)</span><br><span class="line">	f.write(str(num + 1).encode(&quot;utf-8&quot;))</span><br><span class="line">	f.close()</span><br><span class="line">	os.remove(&quot;raw/&quot; + raw[0])</span><br><span class="line">	return new_name</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用subprocess产生三个子进程去调用git命令，使这个本地仓库的修改被push到github上的仓库中，最后返回这张图片在github上的地址</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def push_to_github():</span><br><span class="line">	subprocess.call(&quot;git add .&quot;, shell = True)</span><br><span class="line">	subprocess.call(&quot;git commit -m 新增一张图片&quot;, shell = True)</span><br><span class="line">	subprocess.call(&quot;git push origin master&quot;, shell = True)</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>运行<h2 id="py中运行"><a href="#py中运行" class="headerlink" title="py中运行"></a>py中运行</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">	pic_name = deliver_image()</span><br><span class="line">	if pic_name != False:</span><br><span class="line">		push_to_github()</span><br><span class="line">		print(&quot;图片的url:&quot;)</span><br><span class="line">		print(&quot;https://raw.githubusercontent.com/gzm1997/gallery/master/mature/&quot; + pic_name)</span><br><span class="line">		stop = input(&quot;确认退出:&quot;)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="cmd中"><a href="#cmd中" class="headerlink" title="cmd中"></a>cmd中</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python add.py</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/22/自制简易图片云盘/" data-id="cjq20hcbw004gyoo0nj80gcz0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/image/">image</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-sqlalchemy一些常见概念" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/16/sqlalchemy一些常见概念/" class="article-date">
  <time datetime="2018-05-16T08:00:53.000Z" itemprop="datePublished">2018-05-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/16/sqlalchemy一些常见概念/">sqlalchemy一些常见概念</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="metadata"><a href="#metadata" class="headerlink" title="metadata"></a>metadata</h2><p>官方文档解释</p>
<blockquote>
<p>The MetaData is a registry which includes the ability to emit a limited set of schema generation commands to the database. As our SQLite database does not actually have a users table present, we can use MetaData to issue CREATE TABLE statements to the database for all tables that don’t yet exist. Below, we call the MetaData.create_all() method, passing in our Engine as a source of database connectivity</p>
</blockquote>
<p>metadata是一个注册器，里面包含一些数据库的模式生成命令，可以调用metadata发起create table命令来创建这个表</p>
<p><img src="http://static.zybuluo.com/gzm1997/y94c7jye04to8blqvbn15su3/image_1cdjqt91j1hpr34cos1euqodr9.png" alt="image_1cdjqt91j1hpr34cos1euqodr9.png-5.9kB"></p>
<hr>
<h2 id="mapper"><a href="#mapper" class="headerlink" title="mapper"></a>mapper</h2><p>sqlalchemy中创建一个继承declarative_base的类的本质是，创建一个class的同时生成一个同名的Table对象，并且使用一个mapper对象将两个对象映射在一起。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'my_table'</span></span><br><span class="line">    id = Column(Integer, primary_key=<span class="keyword">True</span>)</span><br><span class="line">    type = Column(String(<span class="number">50</span>))</span><br><span class="line">    alt = Column(<span class="string">"some_alt"</span>, Integer)</span><br><span class="line"></span><br><span class="line">    __mapper_args__ = &#123;</span><br><span class="line">        <span class="string">'polymorphic_on'</span> : type</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>上述代码跟下面效果是一样的<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">my_table = Table(<span class="string">"my_table"</span>, metadata,</span><br><span class="line">    Column(<span class="string">'id'</span>, Integer, primary_key=<span class="keyword">True</span>),</span><br><span class="line">    Column(<span class="string">'type'</span>, String(<span class="number">50</span>)),</span><br><span class="line">    Column(<span class="string">"some_alt"</span>, Integer)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">mapper(MyClass, my_table,</span><br><span class="line">    polymorphic_on=my_table.c.type,</span><br><span class="line">    properties=&#123;</span><br><span class="line">        <span class="string">'alt'</span>:my_table.c.some_alt</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="对象状态转换"><a href="#对象状态转换" class="headerlink" title="对象状态转换"></a>对象状态转换</h2><p><img src="http://static.zybuluo.com/gzm1997/j5p2qxy0l2s5t54tvk4jx59y/image_1cdjs8hm616i15k3vss1r6u17ju3j.png" alt="image_1cdjs8hm616i15k3vss1r6u17ju3j.png-14.2kB"></p>
<p>值得一提的是，当class被add到session中，但是没有commit，此时这个class并没有被写入数据库，但是此时进行query查询这个class是可以被查询出来的，因为当执行query时，执行了flush操作，调用了sql语句，这个class对应的row被生成。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> Column, String, Integer, ForeignKey, create_engine</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> sessionmaker, relationship, backref</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.ext.declarative <span class="keyword">import</span> declarative_base</span><br><span class="line">Base = declarative_base()</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">"user"</span></span><br><span class="line">    id = Column(Integer, primary_key = <span class="keyword">True</span>)</span><br><span class="line">    name = Column(String(<span class="number">20</span>))</span><br><span class="line"></span><br><span class="line">engine = create_engine(<span class="string">'mysql+mysqlconnector://root:Gzm20125@localhost:3306/test'</span>)</span><br><span class="line">DBSession = sessionmaker(bind = engine)</span><br><span class="line"></span><br><span class="line">Base.metadata.drop_all(engine)</span><br><span class="line">Base.metadata.create_all(engine)</span><br><span class="line"><span class="comment"># 创建session对象:</span></span><br><span class="line"></span><br><span class="line">session = DBSession()</span><br><span class="line"></span><br><span class="line">u = User(id = <span class="number">1</span>, name = <span class="string">"gzm"</span>)</span><br><span class="line">session.add(u)</span><br><span class="line">print(session.query(User).filter_by(id = <span class="number">1</span>).first())</span><br></pre></td></tr></table></figure>
<p>输出<br><img src="http://static.zybuluo.com/gzm1997/2uovj0ildc954przw50hrcia/image_1cdjsg49k1qk49j6192o1vmd1vdp40.png" alt="image_1cdjsg49k1qk49j6192o1vmd1vdp40.png-13.5kB"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/16/sqlalchemy一些常见概念/" data-id="cjq20hc9s001pyoo0w75aq1b0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sqlalchemy/">sqlalchemy</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-软件生命周期" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/15/软件生命周期/" class="article-date">
  <time datetime="2018-05-15T15:02:50.000Z" itemprop="datePublished">2018-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/15/软件生命周期/">软件生命周期</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>这几天我都在深深地反思，发现自己的确是一个很功利的人，从框架的工具化就可以看出来。越是患得患失就越容易失去。我觉得我这段时间可以多写点代码，并且这不能很以往一样，一个劲地写，应该从工程上开始考量所有问题。</p>
</blockquote>
<hr>
<h2 id="软件生命周期6大阶段"><a href="#软件生命周期6大阶段" class="headerlink" title="软件生命周期6大阶段"></a>软件生命周期6大阶段</h2><ol>
<li>可行性分析和计划阶段<ul>
<li>确定软件开发的总体目标，给出功能，性能，可靠性，接口等方面的要求，进行可行性分析</li>
<li>估计可利用的资源(硬件，软件，人力等)，成本，效益，开发进度，进行投资收益分析，制定开发计划</li>
<li>提交可行性分析报告，开发计划等文档</li>
</ul>
</li>
<li>需求分析阶段<ul>
<li>分析用户提出的要求，给出需求详细定义，确定软件系统的各项功能，性能需求和设计约束，确定对文档的编制的要求</li>
<li>提交软件需求说明，软件规格说明，数据要求说明等文档和初步用户手册</li>
</ul>
</li>
<li>设计阶段<ul>
<li>概要设计：将各项需求转换为软件的体系结构。软件的每一组成部分都是意义明确的模块，每个模块和某些需求相对应</li>
<li>详细设计：对没一个模块要完成的工作进行具体的描述，提供源编程编写的直接依据</li>
<li>提交结构设计说明，详细设计说明和测试计划初稿等文稿</li>
</ul>
</li>
<li>实现阶段<ul>
<li>实现源码编码，编译，和排错调试，得到没有语法错误的程序清单。程序结构良好，清晰易读，且与设计想一致</li>
<li>编写进度日报，周报，和月报</li>
<li>提交用户手册，操作手册等面向用户的文档的编写工作</li>
<li>编写测试计划</li>
</ul>
</li>
<li>测试阶段<ul>
<li>全面测试目标软件系统，并检查审阅已编制的文档，提交测试分析报告。逐项评价所生产的程序、文档以及开发工作本身，提交项目开发总结报告</li>
<li>在整个开发过程中 (即前五个阶段中)，开发集体需要按月编写<br>开发进度月报。</li>
</ul>
</li>
<li>运行与维护阶段<ul>
<li>软件提交给用户后，在运行使用中得到持续维护，根据用户新<br>提出的需求进行必要而且可能的扩充、删改、更新和升级。</li>
<li>软件维护包括改正性维护 (发现错误)、适应性维护 (适应运行<br>环境变化) 和完善性维护 (增强功能)。</li>
</ul>
</li>
</ol>
<hr>
<h2 id="常见软件生命周期模型"><a href="#常见软件生命周期模型" class="headerlink" title="常见软件生命周期模型"></a>常见软件生命周期模型</h2><blockquote>
<p>软件开发过程一般应该采用某种类型的软件生命周期模型，按<br>照一定的开发方法，使用相应的工具系统实现。</p>
</blockquote>
<p>常见模型</p>
<ul>
<li>瀑布模型 (Waterfall Model)</li>
<li>V-W 模型 (V Model and W Model)</li>
<li>快速应用开发模型 (RAD Model)</li>
<li>原型模型 (Prototype Model)</li>
<li>增量/演化/迭代模型 (Incremental Model)</li>
<li>螺旋模型 (Spiral Model)</li>
<li>喷泉模型 (Fountain Model, Object-Oriented Model)</li>
<li>基于构件的开发模型 (CBSD Model)</li>
<li>Rational 统一过程模型 (RUP Model)</li>
<li>*敏捷开发模型与极限编程 (Agile Modeling and XP)</li>
</ul>
<hr>
<h2 id="瀑布模型"><a href="#瀑布模型" class="headerlink" title="瀑布模型"></a>瀑布模型</h2><p><img src="http://static.zybuluo.com/gzm1997/ovwgmbl03ugmj2l9sm1p0jfy/image_1c8ias8gck9c5rmro9cihae89.png" alt="image_1c8ias8gck9c5rmro9cihae89.png-96.4kB"></p>
<p>特征</p>
<ul>
<li>每一阶段工作对象来自于上一阶段的输出</li>
<li>根据本阶段的活动规程执行相应的任务</li>
<li>本阶段产生相关软件工件，作为下一阶段活动的输入</li>
<li>对本阶段的活动情况进行评审</li>
</ul>
<p>优点</p>
<ul>
<li>降低软件开发的复杂程度，提高软件开发过程的透明性，提高软件开发过程的可管理性</li>
<li>推迟软件实现，强调在软件实现前必须进行分析和设计工作</li>
<li>以项目的阶段评审和文档控制为手段有效地对整个开发过程进行指导，保证了阶段之间的正确衔接，能够及时发现并纠正开发过程中存在的缺陷，使产品达到预期的质量要求</li>
</ul>
<p>缺点</p>
<ul>
<li>强调过程活动的线性顺序</li>
<li>缺乏灵活性，特别是无法解决软件需求不明确或不准确的问题</li>
<li>风险控制能力较弱</li>
<li>瀑布模型中的软件活动是文档驱动的，当阶段之间规定过多的文档时，会极大地增加系统的工作量</li>
<li>管理人员如果仅仅以文档的完成情况来评估项目完成进度，往往会产生错误的结论</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/15/软件生命周期/" data-id="cjq20hcbk003qyoo0lz6rp5d7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/软件开发生命周期/">软件开发生命周期</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-sysu教务选课系统登陆" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/15/sysu教务选课系统登陆/" class="article-date">
  <time datetime="2018-05-15T15:01:05.000Z" itemprop="datePublished">2018-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/15/sysu教务选课系统登陆/">sysu教务选课系统登陆</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>准备：<br>python3<br>安装tesseract,本人提供的tesseract百度云下载，亲测版本4比较多坑，这是版本3，已经够用的了<br>链接: <a href="http://pan.baidu.com/s/1boHp2Jt" target="_blank" rel="noopener">http://pan.baidu.com/s/1boHp2Jt</a> 密码: 6trj</p>
<hr>
<ul>
<li>下载本项目到本地</li>
<li>进入主目录，输入以下命令安装相关依赖：</li>
</ul>
<pre><code>pip install -r requirements.txt
</code></pre><ul>
<li><p>在如下59和64行输入你的账号和密码：<br><img src="https://github.com/15331094/sysu_login/blob/master/screenshots/input.png?raw=true" alt="输入账号密码"></p>
</li>
<li><p>输入一下命令运行代码：</p>
<p> python login.py</p>
</li>
</ul>
<p>运行之后打印不少内容：<br>第一个是一个byte,内容就是下载下来的验证码：<br><img src="https://github.com/15331094/sysu_login/blob/master/screenshots/icode.png?raw=true" alt="验证码"><br>第二个是登陆后的页面：<br><img src="https://github.com/15331094/sysu_login/blob/master/screenshots/after_login.png?raw=true" alt="登陆之后"><br>第三个是我的选课结果：<br><img src="https://github.com/15331094/sysu_login/blob/master/screenshots/my_lesson.png?raw=true" alt="选课结果"></p>
<hr>
<p>最后可以发现本地生成了一个after_login.html的html文件，打开之后发现你的选课结果被下载下来了：<br><img src="https://github.com/15331094/sysu_login/blob/master/screenshots/lession.png?raw=true" alt="选课结果"></p>
<h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><ul>
<li>icode模块负责图片去噪和识别验证码</li>
<li>entryption模块负责加密密码</li>
<li>login模块负责登陆和抓取一些页面</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/15/sysu教务选课系统登陆/" data-id="cjq20hcb4003cyoo02cb70muz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/requests/">requests</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-上传和展示pdf以及markdown" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/15/上传和展示pdf以及markdown/" class="article-date">
  <time datetime="2018-05-15T14:57:44.000Z" itemprop="datePublished">2018-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/15/上传和展示pdf以及markdown/">上传和展示pdf以及markdown</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><p><a href="http://138.68.235.123/upload" target="_blank" rel="noopener">查看地址</a></p>
<p><a href="http://138.68.235.123/show?file_name=readme.pdf" target="_blank" rel="noopener">pdf版本readme地址</a></p>
<hr>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这个是开学前跟别人赌气写下的一个很小的web app，功能是上传pdf文件，然后获得这个文件在线浏览的url，需求很简单。之前为了方便只是把上传到服务器的文件存在flask static文件夹下，会有不便于管理等等问题。这个周末做了如下改进：使用mysql进行存储文件，进行模块的细化。</p>
<p align="right">郭柱明 2018/3/25</p>


<hr>
<h2 id="可行性分析"><a href="#可行性分析" class="headerlink" title="可行性分析"></a>可行性分析</h2><blockquote>
<p>从需求上而言，这个web app仅仅有上传，展示两个功能。<br>我一个人可以进行开发，但是在人力物力上已经绰绰有余。<br>在app的服务器部署上，我有一个digital ocean vps可以用来部署，所以部署上也没有太大问题。</p>
</blockquote>
<hr>
<h2 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h2><ol>
<li>上传pdf文件</li>
<li>获得在线浏览此pdf文件的url</li>
<li>打开这个url可以进行文件的预览</li>
</ol>
<hr>
<h2 id="设计"><a href="#设计" class="headerlink" title="设计"></a>设计</h2><p>###大概设计###</p>
<p><img src="http://static.zybuluo.com/gzm1997/5de0ll4jozkxxzntxo20ni2x/struction.png" alt="struction.png-12.1kB"></p>
<p>整个结构呈现cs结构，server我使用nginx，server使用wsgi接口调用flask app</p>
<p>###详细设计###</p>
<ul>
<li>包-pdf(整个web app打包为一个包)<ul>
<li>db.py模块(定义一个包含数据库链接的类以及初始化数据库的函数)</li>
<li>f.py模块(定义File类)</li>
</ul>
</li>
</ul>
<hr>
<h2 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h2><blockquote>
<p>编码情况详细见<a href="https://github.com/gzm1997/pdf" target="_blank" rel="noopener">github</a></p>
</blockquote>
<hr>
<h2 id="测试与运行"><a href="#测试与运行" class="headerlink" title="测试与运行"></a>测试与运行</h2><p><img src="http://static.zybuluo.com/gzm1997/v93gqdz11aenv30kisr64r41/pdf.gif" alt="pdf.gif-631.7kB"></p>
<hr>
<h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><blockquote>
<p>部署有个问题：无法从事先设置的环境变量中加载出mysql的账号和密码，在服务器上调试没问题，但是一旦部署上去就会在这部分出问题，无奈下只能在代码使用mysql的账号密码，有一定的安全风险。</p>
</blockquote>
<hr>
<h2 id="后期改进"><a href="#后期改进" class="headerlink" title="后期改进"></a>后期改进</h2><blockquote>
<p>增加了上传和预览markdown文件的功能，具有改进为博客系统的潜质</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/15/上传和展示pdf以及markdown/" data-id="cjq20hcbh003myoo0ltk6gam2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flask/">flask</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-暗网爬虫" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/15/暗网爬虫/" class="article-date">
  <time datetime="2018-05-15T14:54:11.000Z" itemprop="datePublished">2018-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/15/暗网爬虫/">暗网爬虫</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>暗网蜘蛛，本项目<a href="https://github.com/15331094/shadow_spider" target="_blank" rel="noopener">github地址</a></p>
<hr>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/spider.jpg?raw=true" alt="shadow_spider"></p>
<hr>
<p>暗网</p>
<blockquote>
<p>暗网（英语：Darknet或Dark Web）通称只能用特殊软件、特殊授权、或对电脑做特殊设置才能连上的网络，使用一般的浏览器和搜索引擎找不到暗网的内容</p>
</blockquote>
<hr>
<h2 id="在python上进入暗网"><a href="#在python上进入暗网" class="headerlink" title="在python上进入暗网"></a>在python上进入暗网</h2><hr>
<p>在python中进入暗网需要配置tor代理，因为本人使用的win10，所以主要讲在win10下配置tor代理</p>
<hr>
<p><strong>下载准备</strong>：（除了下载给出的下载链接，本人此项目github也提供相关资源下载 <a href="https://github.com/15331094/shadow_spider/tree/master/resources" target="_blank" rel="noopener">下载链接</a>）</p>
<ol>
<li><p>首先下载tor expert bundle<br>官方下载<a href="https://www.torproject.org/download/download" target="_blank" rel="noopener">链接</a><br>本人提供的百度云<a href="http://pan.baidu.com/s/1eRNpqa2" target="_blank" rel="noopener">链接</a>，密码: fsp8<br>下载解压</p>
</li>
<li><p>下载到的tor expert bundle没有图形界面，使用起来不方便，因此需要下载Vidalia配合使用<br>本人提供的百度云<a href="http://pan.baidu.com/s/1bOdr6e" target="_blank" rel="noopener">链接</a>，密码: kknf</p>
</li>
<li><p>cow下载，百度云<a href="http://pan.baidu.com/s/1c1QHf1m" target="_blank" rel="noopener">连接</a>，密码: c4kx。<br>由于tor使用的协议是socks5，由于需要python的<strong>requests</strong>和<strong>selenium</strong>两个模块进行get， post请求。但是经过本人尝试，requests对socks5协议代理支持是很不良好的，使用requests加上socks5协议代理去get类似于 <a href="https://api.ipify.org/?format=json" target="_blank" rel="noopener">https://api.ipify.org/?format=json</a> 这样查询ip的url是没有问题的，但是去get其他url或者暗网的url马上会出现莫名其妙的错误。所以需要使用cow把tor的socks5协议转为http协议</p>
</li>
</ol>
<hr>
<p><strong>配置</strong></p>
<hr>
<p>我们要配置上面下载到的工具，使得我们的代理路线如下：<br><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/net.png?raw=true" alt="net"><br>1,解压下载下来的tor expert bundle</p>
<p>2,开启你的vpn，本人使用的green vpn，socks5协议，监听1080端口</p>
<p>3,安装vidalia，安装后如图所示：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/vidalia.png?raw=true" alt="vidalia"></p>
<p>然后以<strong>管理员身份</strong>运行Start Vidalia.exe</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/vidalia%20run.png?raw=true" alt="vidalia run"></p>
<p>点击设定，在常规那里选中vidalia启动时运行tor软件，并在下面的路径中找到解压tor expert bundle后得到的tor.exe</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/setting1.png?raw=true" alt="setting1"></p>
<p>点击网络，选中我使用代理服务器连接网络，由于本人使用的green vpn是监听本地的1080端口，所以地址写为：127.0.0.1，端口写为：1080（貌似shadowsocks等vpn也是监听本地1080端口）</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/setting2.png?raw=true" alt="setting2"></p>
<p>点击高级，在tor配置文件下选中vidalia安装后得到的Data/Tor/torrc文件，在数据目录那里选中Data文件夹（貌似我是多余地自己另外创建了一个Data文件夹给它，但是并不影响，有一个Data文件夹给vidalia存储数据就可以了）</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/setting3.png?raw=true" alt="setting3"></p>
<p>点击确认</p>
<p>点击启动tor</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/run.png?raw=true" alt="run"></p>
<p>稍等片刻，显示连接tor网络成功！</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/connect.png?raw=true" alt="connect"></p>
<p>因为需要在requests模块上使用tor代理而requests模块对socks5支持非常不良好，所以我们需要配置cow把socks5转为http<br>打开解压后的cow目录：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/cow.png?raw=true" alt="cow"></p>
<p>修改rc.txt内容为如下：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/rc.png?raw=true" alt="rc"></p>
<p>点击运行cow.exe或者点击cow-hide.exe后台运行</p>
<hr>
<p><strong>在python中使用tor代理</strong></p>
<hr>
<p>再次重申上面配置好的代理结构：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/net.png?raw=true" alt="net"></p>
<p>能否正常使用tor代理一个很好的检验方法就是能否<strong>进入暗网</strong>，这是一个收集了很多暗网url的网站：<a href="https://onionlinks.org/" target="_blank" rel="noopener">https://onionlinks.org/</a></p>
<p>我给出一个暗网url:<strong><a href="http://hcutffpecnc44vef.onion/" target="_blank" rel="noopener">http://hcutffpecnc44vef.onion/</a></strong><br>这是一个暗网的金融网站，普通的上网方式是打不开的，作为一个大哥哥，真心建议18-的小朋友还是不要去看暗网一些其他内容，为了你的身心健康。那下面的测试就是在python中进入这个暗网url为检验标准。</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/cash%20machine.png?raw=true" alt="cash machine"></p>
<p><em>在requests中进入暗网</em>：<br>新建一个test.py,输入以下内容：</p>
<pre><code>import requests
proxies = {&apos;http&apos;: &apos;http://127.0.0.1:7777&apos;, &apos;https&apos;: &apos;http://127.0.0.1:7777&apos;}
s = requests.Session()
r = s.get(&quot;http://hcutffpecnc44vef.onion/&quot;, proxies = proxies)
print(r.text)
f = open(&quot;onion.html&quot;, &quot;wb&quot;)
f.write(r.content)
f.close()
</code></pre><p>运行，发现可以打印这个暗网网页的内容出来了：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/run%20test.png?raw=true" alt="run test"></p>
<p>打开test.py同一目录下，生成了一个onion.html的文件，点开，发现把内容也下载下来了：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/get.png?raw=true" alt="get"></p>
<p><em>在python的selenium模块的模拟浏览器phantomjs中进入暗网</em><br>selenium有三种，chrome，firefox，phantomjs，前两种有图形界面，第三种没有图形界面，所以我选中phantomjs</p>
<p>phantomjs下载：<br>本人github上的下载<a href="https://github.com/15331094/shadow_spider/blob/master/resources/phantomjs-2.1.1-windows.zip" target="_blank" rel="noopener">下载链接</a><br>本人百度云<a href="http://pan.baidu.com/s/1eSxNa86" target="_blank" rel="noopener">下载链接</a>，密码: pj81</p>
<p>这次我们选择另一个暗网url:<a href="http://zqktlwi4fecvo6ri.onion/wiki/index.php/Main_Page" target="_blank" rel="noopener">http://zqktlwi4fecvo6ri.onion/wiki/index.php/Main_Page</a><br>这是一个暗网wiki，上面有很多分类好的暗网url,各位要谨慎点开那些url，因为不少内容不健康的。<br>下载phantomjs解压，新建一个test2.py文件(下面的executable_path是上面下载解压phantomjs得到的phantomjs.exe运行文件的路径)</p>
<pre><code>from selenium import webdriver

executable_path = &quot;C:/Users/Administrator/Downloads/phantomjs-2.1.1-windows/phantomjs-2.1.1-windows/bin/phantomjs.exe&quot;
service_args = [&apos;--proxy=127.0.0.1:7777&apos;, &apos;--proxy-type=http&apos;]

driver = webdriver.PhantomJS(executable_path = executable_path, service_args = service_args)

driver.get(&quot;http://zqktlwi4fecvo6ri.onion/wiki/index.php/Main_Page&quot;)

print(driver.page_source)

f = open(&quot;onion.html&quot;, &quot;wb&quot;)
f.write(driver.page_source.encode(&quot;utf-8&quot;))
f.close()
</code></pre><p>结果也可行：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/run%20test2.png?raw=true" alt="run test2"><br><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/wiki.png?raw=true" alt="wiki"></p>
<hr>
<h2 id="本人的shadow-spider项目（未完待续）"><a href="#本人的shadow-spider项目（未完待续）" class="headerlink" title="本人的shadow_spider项目（未完待续）"></a>本人的shadow_spider项目（未完待续）</h2><hr>
<p>项目<a href="https://github.com/15331094/shadow_spider" target="_blank" rel="noopener">github地址</a><br>本项目目的在于最大程度还原暗网上网页的内容，这就意味着需要：</p>
<p>注意要点：</p>
<ul>
<li>下载html</li>
<li>在下载html之前必须加载javascript。因为javascript里面会有ajax，如果把javascript下载下来，而不是加载完javascript再下载html，那么下载到本地ajax向tor网络（暗网）中的服务器发送网络请求，这是行不通的。所以必须加载完javascript再下载html（网上有人说暗网上的网页都没有javascript，但是经本人尝试，暗网上的网页是有javascript的）。而python里加载javascript一个很好的工具就是上面的selenium</li>
<li>下载css和图片等静态资源，需要使用requests模块，不能使用selenium。selenium下载图片和css等资源是很蛋疼的。因为这些模拟浏览器要下载资源就必须做到模仿我们在真的浏览器上那样右键另存为等操作，而这时候会弹出下载确认的弹窗，而selenium中的chrome和firefox是需要手动点击代码运行过程中弹出来的确认保存弹窗的，而phantomjs没有图形界面，所以就根本下载不图片和css等资源。</li>
</ul>
<p>代码细节不详细说了，在我的<a href="https://github.com/15331094/shadow_spider" target="_blank" rel="noopener">github</a>中下载到本地，输入：</p>
<pre><code>pip install -r requirements.txt
</code></pre><p>安装需要的响应模块</p>
<p>运行main.py文件，输入一个暗网url:</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/run%20main.png?raw=true" alt="run main"></p>
<p>下载到本地的结果：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/result.png?raw=true" alt="result"></p>
<p>下面是一些暗网网页真实模样和我还原的样子：<br>真实1：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/real1.png?raw=true" alt="real1"></p>
<p>还原1：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/imitate1.png?raw=true" alt="imitate1"></p>
<p>真实2：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/real2.png?raw=true" alt="real2"></p>
<p>还原2：</p>
<p><img src="https://github.com/15331094/shadow_spider/blob/master/screenshots/imitate2.png?raw=true" alt="imitate2"></p>
<p>此项目shadow_spider未完待续，等到暑假回考虑添加服务端。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/15/暗网爬虫/" data-id="cjq20hcbo003uyoo05yu2mms7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/deep-web/">deep web</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-sqlalchemy级联" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/15/sqlalchemy级联/" class="article-date">
  <time datetime="2018-05-15T14:37:01.000Z" itemprop="datePublished">2018-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/15/sqlalchemy级联/">sqlalchemy级联</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="relationship"><a href="#relationship" class="headerlink" title="relationship"></a>relationship</h2><p>relationship是sqlalchemy中的用于创建两个对象之间的关系的一个对象，跟原本的mysql没有太大关系，但是relationship一定要建立在具有外键关系的两个对象上</p>
<p>例如<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">"user"</span></span><br><span class="line">    id = Column(Integer, primary_key = <span class="keyword">True</span>)</span><br><span class="line">    name = Column(String(<span class="number">20</span>))</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">"article"</span></span><br><span class="line">    id = Column(Integer, primary_key = <span class="keyword">True</span>)</span><br><span class="line">    user_id = Column(Integer, ForeignKey(<span class="string">"user.id"</span>))</span><br><span class="line">    user = relationship(<span class="string">"User"</span>, order_by = <span class="string">"Article.id"</span>, backref = backref(<span class="string">"article"</span>), cascade = <span class="string">"save-update, merge, delete"</span>)</span><br></pre></td></tr></table></figure></p>
<p>user和article之间是一对多的关系，由于article具有</p>
<pre><code>user = relationship(&quot;User&quot;, order_by = &quot;Article.id&quot;, backref = backref(&quot;article&quot;), cascade = &quot;save-update, merge, delete&quot;)
</code></pre><p>字段，所以article具有user属性，也即article.user可以获取article对应的user</p>
<p>同时因为</p>
<pre><code>backref = backref(&quot;article&quot;)
</code></pre><p>使得user具有article属性，由外键关系知道user和article为一对多关系，所以，user.article类型为[]。</p>
<p>backref和back_populates<br>stackoverflow上对两者的解释</p>
<blockquote>
<p>If you use backref you don’t need to declare the relationship on the second table</p>
</blockquote>
<p>就是使用backref就不用再两个具有外键的类上都声明relationship。</p>
<p>backref<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'parent'</span></span><br><span class="line">    id = Column(Integer, primary_key=<span class="keyword">True</span>)</span><br><span class="line">    children = relationship(<span class="string">"Child"</span>, backref=<span class="string">"parent"</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'child'</span></span><br><span class="line">    id = Column(Integer, primary_key=<span class="keyword">True</span>)</span><br><span class="line">    parent_id = Column(Integer, ForeignKey(<span class="string">'parent.id'</span>))</span><br></pre></td></tr></table></figure></p>
<p>back_populates<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'parent'</span></span><br><span class="line">    id = Column(Integer, primary_key=<span class="keyword">True</span>)</span><br><span class="line">    children = relationship(<span class="string">"Child"</span>, back_populates=<span class="string">"parent"</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'child'</span></span><br><span class="line">    id = Column(Integer, primary_key=<span class="keyword">True</span>)</span><br><span class="line">    parent_id = Column(Integer, ForeignKey(<span class="string">'parent.id'</span>))</span><br><span class="line">    parent = relationship(<span class="string">"Parent"</span>, back_populates=<span class="string">"children"</span>)</span><br></pre></td></tr></table></figure></p>
<p>上面两者是等价的</p>
<hr>
<h2 id="cascade级联"><a href="#cascade级联" class="headerlink" title="cascade级联"></a>cascade级联</h2><p>例子中</p>
<pre><code>cascade = &quot;save-update, merge, delete&quot;
</code></pre><p>属性用来表示这两个关联起来的对象的增删的时候之间的关系</p>
<p><strong>cascade默认值为save-update, merge</strong></p>
<p><strong>为了表达更清晰</strong>，声明了relationship属性的类我们称之为<strong>子类</strong>，没有声明的我们称之为<strong>父类</strong>，使用上面的user和article例子<br><img src="http://static.zybuluo.com/gzm1997/09845m65v996usjz8kr4dc9n/image_1cdi1seaqu2sntue61gq51la29.png" alt="image_1cdi1seaqu2sntue61gq51la29.png-6.8kB"></p>
<p>1.save-update</p>
<ul>
<li>当user被add到session中的时候，两个article也自动被add到session中了</li>
<li>当article1被添加到session中时，user自动被添加进session，同时article2也会自动被添加进去</li>
</ul>
<p>2.delete</p>
<ul>
<li>当删除子对象时，父对象也一起被删除，如果子对象有指向父对象的外键且这个外键指向这个被删除的父对象，那么这个外键设置为null</li>
<li>当删除父对象时，子对象没有删除，如果子对象有指向父对象的外键且这个外键指向这个被删除的父对象，那么外键设置为null</li>
</ul>
<p>3.delete-orphan</p>
<blockquote>
<p>delete-orphan实在delete的基础上，加上当子对象被解除跟父对象的关系的时候就会被标志为删除</p>
</blockquote>
<p>4.其他还有merge，refresh-expire，expunge那些不常用的就不要求理解了</p>
<hr>
<h2 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> Column, String, Integer, ForeignKey, create_engine</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> sessionmaker, relationship, backref</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.ext.declarative <span class="keyword">import</span> declarative_base</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Base = declarative_base()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">"user"</span></span><br><span class="line">    id = Column(Integer, primary_key = <span class="keyword">True</span>)</span><br><span class="line">    name = Column(String(<span class="number">20</span>))</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">"article"</span></span><br><span class="line">    id = Column(Integer, primary_key = <span class="keyword">True</span>)</span><br><span class="line">    user_id = Column(Integer, ForeignKey(<span class="string">"user.id"</span>))</span><br><span class="line">    user = relationship(<span class="string">"User"</span>, order_by = <span class="string">"Article.id"</span>, backref = backref(<span class="string">"article"</span>), cascade = <span class="string">"save-update, merge, delete"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">engine = create_engine(<span class="string">'mysql+mysqlconnector://root:Gzm20125@localhost:3306/test'</span>)</span><br><span class="line">DBSession = sessionmaker(bind = engine)</span><br><span class="line"></span><br><span class="line">Base.metadata.drop_all(engine)</span><br><span class="line">Base.metadata.create_all(engine)</span><br><span class="line"><span class="comment"># 创建session对象:</span></span><br><span class="line"></span><br><span class="line">session = DBSession()</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/15/sqlalchemy级联/" data-id="cjq20hc9w001vyoo0zawukis4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sqlalchemy/">sqlalchemy</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-多维数组最短路径问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/06/多维数组最短路径问题/" class="article-date">
  <time datetime="2018-05-06T08:18:02.079Z" itemprop="datePublished">2018-05-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/06/多维数组最短路径问题/">多维数组最短路径问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>题目<br>给定一个矩阵m，从左上角开始每次只能向右或者向下走，最后到达右下角的位置，路径上所有的数字累加起来就是路径和，返回所有路径中最小的路径和。<br>例子：<br>给定m如下：<br>1 3 5 9<br>8 1 3 4<br>5 0 6 1<br>8 8 4 0<br>路径1,3,1,0,6,1,0是所有路径中路径和最小的，所以返回12。</p>
<blockquote>
<p>一般这种这种问题可以通过动态规划来解决，因为去年没选算法导论，一直对动态规划这个概念理解不是很清楚</p>
</blockquote>
<p>维基百科上的解释为<br>动态规划（英语：Dynamic programming，简称DP）是一种在数学、管理科学、计算机科学、经济学和生物信息学中使用的，通过把原问题分解为相对简单的子问题的方式求解复杂问题的方法。</p>
<p>以往的斐波那契数列和背包问题都是用到动态规划的思想，只是一直知道这就是动态规划而已。</p>
<p>最短路径问题：<br>设一个数组dp[n][n]，用来存从0，0点到这一点的最短路径和，对于每一点dp[i][j]的值，它等于min(dp[i-1][j], dp[i][j-1]) + arr[i][j]，特别的，dp[0][0] = arr[0][0]，对于第一行，dp[0][j] = dp[0][j - 1] + arr[0][j]对于第一列，dp[i][0] = dp[i-1][0] + arr[i][0]</p>
<p>代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">arr = sys.stdin.readline().strip().split(<span class="string">" "</span>)</span><br><span class="line">arr = [[int(i) <span class="keyword">for</span> i <span class="keyword">in</span> arr]]</span><br><span class="line"></span><br><span class="line">num = len(arr[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(num<span class="number">-1</span>):</span><br><span class="line">    new_arr = sys.stdin.readline().strip().split(<span class="string">" "</span>)</span><br><span class="line">    new_arr = [int(i) <span class="keyword">for</span> i <span class="keyword">in</span> new_arr]</span><br><span class="line">    arr.append(new_arr)</span><br><span class="line"></span><br><span class="line">dp = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(num)] <span class="keyword">for</span> i <span class="keyword">in</span> range(num)]</span><br><span class="line">dp[<span class="number">0</span>][<span class="number">0</span>] = arr[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,num):</span><br><span class="line">	dp[<span class="number">0</span>][i] = dp[<span class="number">0</span>][i<span class="number">-1</span>] + arr[<span class="number">0</span>][i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,num):</span><br><span class="line">	dp[i][<span class="number">0</span>] = dp[<span class="number">0</span>][i<span class="number">-1</span>] + arr[<span class="number">0</span>][i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,num):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,num):</span><br><span class="line">		dp[i][j] = min(dp[i<span class="number">-1</span>][j], dp[i][j<span class="number">-1</span>]) + arr[i][j]</span><br><span class="line"></span><br><span class="line">print(dp[num<span class="number">-1</span>][num<span class="number">-1</span>])</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/06/多维数组最短路径问题/" data-id="cjq20hcbd003hyoo0fbfkm8l4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/算法/">算法</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-flask包调用中的的路径问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/06/flask包调用中的的路径问题/" class="article-date">
  <time datetime="2018-05-06T08:00:53.415Z" itemprop="datePublished">2018-05-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/06/flask包调用中的的路径问题/">flask包调用中的的路径问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>这篇短文写在我的腾讯一面搞砸之后，这次面试让我深刻认识到我一直是一个很功利的人。总结了一下一共有几个要点：</p>
<ul>
<li><strong>看需求办事</strong>，有什么需求谷歌什么，查看文档相关部分，而其他的部分置之不理，全然没有深入学习的决心</li>
<li>对一个框架没有深入了解，仅仅止步于<strong>工具化</strong>，也没有对框架有更深层的了解，这让我很惭愧</li>
<li>做事<strong>没有从工程层面</strong>来思考问题，仅仅从个人角度思考问题</li>
</ul>
</blockquote>
<hr>
<h2 id="flask包调用过程中的路径问题"><a href="#flask包调用过程中的路径问题" class="headerlink" title="flask包调用过程中的路径问题"></a>flask包调用过程中的路径问题</h2><p>假设有如下情况,my_app是封装为包的一个flask app，app声明在my_app/__init__.py文件中，h.py是包内的一个辅助模块，在run_app.py中调用my_app这个包的flask app进行运行</p>
<ul>
<li>my_app<ul>
<li>static</li>
<li>templates</li>
<li>__init__.py</li>
<li>h.py</li>
</ul>
</li>
<li>run_app.py</li>
</ul>
<hr>
<p>###在辅助模块h.py中加载static中的静态文件###<br>当情况是运行run_app.py，而h.py需要加载static中静态文件的时候，在h.py中使用的路径可以是两种情况：</p>
<ul>
<li>绝对路径</li>
<li>相对路径 ./my_app/static/file_name</li>
</ul>
<blockquote>
<p>注意包调用情况下，如果包内非__init__模块要加载static内静态文件，需要使用从包外路径开始定位</p>
</blockquote>
<hr>
<p>###html内加载静态文件###<br>当情况是运行run_app.py，html内需要加载静态文件，路径必须是相对路径，形式为：/static/file_name</p>
<hr>
<p>###实例文件夹###<br>flask除了提供 app.static_folder和app.template_folder之外<br><img src="http://static.zybuluo.com/gzm1997/pjq99hklds5g8hdm90oqgvk6/image_1c8h30e029l51fi92jdv9f1rbt9.png" alt="image_1c8h30e029l51fi92jdv9f1rbt9.png-7.8kB"><br>flask还提供了instance_path<br><img src="http://static.zybuluo.com/gzm1997/ymyj8prm5y05y2psgjni1ct9/image_1c8h31ai6r1hidf187l10fo6q6m.png" alt="image_1c8h31ai6r1hidf187l10fo6q6m.png-4.3kB"><br>instance_path也可以用来存放静态文件，但是要注意的是instance_path所在的位置</p>
<p>flask文档对instance_path位置的阐述如下：</p>
<ul>
<li>未安装的模块:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/myapp.py</span><br><span class="line">/instance</span><br></pre></td></tr></table></figure>
<ul>
<li>未安装的包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/myapp</span><br><span class="line">    /__init__.py</span><br><span class="line">/instance</span><br></pre></td></tr></table></figure>
<ul>
<li>已安装的包或模块:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$PREFIX/lib/python2.X/site-packages/myapp</span><br><span class="line">$PREFIX/var/myapp-instance</span><br></pre></td></tr></table></figure>
<blockquote>
<p>$PREFIX 是你 Python 安装的前缀。这个前缀可以是 /usr 或者你的 virtualenv 的路径。你可以打印 sys.prefix 的值来查看前缀被设置成了什么</p>
</blockquote>
<p>所以上面已经阐述得很清楚了，在我们包调用的情况下，instance_path是跟my_app并列的位置上的，所以可以在my_app/__init__.py内的app使用app.instance_path来加载位于与my_app并列的instance中的静态文件，如下：</p>
<ul>
<li>instance<ul>
<li>static_file_to_load</li>
</ul>
</li>
<li>my_app</li>
<li>run.py</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/06/flask包调用中的的路径问题/" data-id="cjq20hc9i001ayoo0034nk30f" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flask深入学习/">flask深入学习</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/3/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ORM/">ORM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aiohttp/">aiohttp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/async/">async</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backend/">backend</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/beego/">beego</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cayley/">cayley</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cookies/">cookies</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cors/">cors</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/">database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deep-web/">deep web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deploy/">deploy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dgraph/">dgraph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask深入学习/">flask深入学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/graph/">graph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gremlin/">gremlin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hugegraph/">hugegraph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/image/">image</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mux/">mux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/package/">package</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rabbitMQ/">rabbitMQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/requests/">requests</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/servlet/">servlet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/session/">session</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/socket/">socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlalchemy/">sqlalchemy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/subgraph/">subgraph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图数据库/">图数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图算法/">图算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图谱/">图谱</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多线程/">多线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线程/">线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件开发生命周期/">软件开发生命周期</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ORM/" style="font-size: 10px;">ORM</a> <a href="/tags/aiohttp/" style="font-size: 17.5px;">aiohttp</a> <a href="/tags/async/" style="font-size: 15px;">async</a> <a href="/tags/backend/" style="font-size: 10px;">backend</a> <a href="/tags/beego/" style="font-size: 12.5px;">beego</a> <a href="/tags/cayley/" style="font-size: 17.5px;">cayley</a> <a href="/tags/cookies/" style="font-size: 10px;">cookies</a> <a href="/tags/cors/" style="font-size: 10px;">cors</a> <a href="/tags/database/" style="font-size: 15px;">database</a> <a href="/tags/deep-web/" style="font-size: 10px;">deep web</a> <a href="/tags/deploy/" style="font-size: 10px;">deploy</a> <a href="/tags/dgraph/" style="font-size: 10px;">dgraph</a> <a href="/tags/docker/" style="font-size: 12.5px;">docker</a> <a href="/tags/flask/" style="font-size: 10px;">flask</a> <a href="/tags/flask深入学习/" style="font-size: 10px;">flask深入学习</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/go/" style="font-size: 20px;">go</a> <a href="/tags/graph/" style="font-size: 10px;">graph</a> <a href="/tags/gremlin/" style="font-size: 10px;">gremlin</a> <a href="/tags/hugegraph/" style="font-size: 10px;">hugegraph</a> <a href="/tags/image/" style="font-size: 10px;">image</a> <a href="/tags/java/" style="font-size: 17.5px;">java</a> <a href="/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/tags/mux/" style="font-size: 10px;">mux</a> <a href="/tags/mysql/" style="font-size: 17.5px;">mysql</a> <a href="/tags/package/" style="font-size: 10px;">package</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/rabbitMQ/" style="font-size: 10px;">rabbitMQ</a> <a href="/tags/requests/" style="font-size: 10px;">requests</a> <a href="/tags/servlet/" style="font-size: 10px;">servlet</a> <a href="/tags/session/" style="font-size: 12.5px;">session</a> <a href="/tags/socket/" style="font-size: 10px;">socket</a> <a href="/tags/sqlalchemy/" style="font-size: 12.5px;">sqlalchemy</a> <a href="/tags/subgraph/" style="font-size: 10px;">subgraph</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/图数据库/" style="font-size: 12.5px;">图数据库</a> <a href="/tags/图算法/" style="font-size: 10px;">图算法</a> <a href="/tags/图谱/" style="font-size: 10px;">图谱</a> <a href="/tags/多线程/" style="font-size: 10px;">多线程</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a> <a href="/tags/线程/" style="font-size: 10px;">线程</a> <a href="/tags/软件开发生命周期/" style="font-size: 10px;">软件开发生命周期</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/12/24/ArrayList相关/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/12/03/暑假学习总结/">暑假学习总结</a>
          </li>
        
          <li>
            <a href="/2018/12/03/subgraph概况/">subgraph概况</a>
          </li>
        
          <li>
            <a href="/2018/12/03/docker在测试中的作用/">docker在测试中的作用</a>
          </li>
        
          <li>
            <a href="/2018/12/03/java基础：入职华为前的重启/">java基础：入职华为前的重启</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 gzm1997<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>